!function(t,i){"use strict";class e{}e.allowSleeping=!1,e.gravity={x:0,y:9.8},e.customUpdate=!1,e.velocityIterations=8,e.positionIterations=3,e.pixelRatio=50,e.debugDraw=!0,e.drawShape=!0,e.drawJoint=!0,e.drawAABB=!1,e.drawCenterOfMass=!1;class o extends i.EventDispatcher{constructor(){super(...arguments),this._eventList=[]}static get I(){return o._I||(o._I=new o)}set enableDebugDraw(t){t?this._factory.createDebugDraw(this._factory.drawFlags_shapeBit):this._factory.removeDebugDraw()}set drawShape(t){let i=this._factory.drawFlags_shapeBit;t?this._factory.appendFlags(i):this._factory.clearFlags(i)}set drawJoint(t){let i=this._factory.drawFlags_jointBit;t?this._factory.appendFlags(i):this._factory.clearFlags(i)}set drawAABB(t){let i=this._factory.drawFlags_aabbBit;t?this._factory.appendFlags(i):this._factory.clearFlags(i)}set drawPair(t){let i=this._factory.drawFlags_pairBit;t?this._factory.appendFlags(i):this._factory.clearFlags(i)}set drawCenterOfMass(t){let i=this._factory.drawFlags_centerOfMassBit;t?this._factory.appendFlags(i):this._factory.clearFlags(i)}get allowSleeping(){return this._factory.allowSleeping}set allowSleeping(t){this._factory.allowSleeping=t}get gravity(){return this._factory.gravity}set gravity(t){this._factory.gravity=t}get worldRoot(){return this._worldRoot||i.ILaya.stage}set worldRoot(t){if(this._worldRoot=t,t){var e=t.localToGlobal(i.Point.TEMP.setTo(0,0));this._factory.shiftOrigin(-e.x,-e.y)}}get bodyCount(){return this._factory.bodyCount}get contactCount(){return this._factory.contactCount}get jointCount(){return this._factory.jointCount}_addRigidBody(t){this._rigiBodyList.add(t)}_removeRigidBody(t){this._rigiBodyList.remove(t)}_updataRigidBodyAttribute(t){this._updataattributeLists.add(t)}_removeRigidBodyAttribute(t){this._updataattributeLists.remove(t)}_update(){for(var t=0,e=this._updataattributeLists.length;t<e;t++)this._updataattributeLists.elements[t]._updatePhysicsAttribute();this._updataattributeLists.clear();var o=Math.min(i.ILaya.timer.delta/1e3,.033);this._factory.update(o),this._updatePhysicsTransformToRender();var s=this._eventList.length;if(s>0){for(t=0;t<s;t+=2)this._factory.sendEvent(this._eventList[t],this._eventList[t+1]);this._eventList.length=0}}_updatePhysicsTransformToRender(){for(var t=0,i=this._rigiBodyList.length;t<i;t++)this._rigiBodyList.elements[t]._updatePhysicsTransformToRender()}enable(){return this._factory?(null!=i.PlayerConfig.physics2D&&Object.assign(e,i.PlayerConfig.physics2D),this._factory.initialize().then((()=>(this.start(),Promise.resolve())))):Promise.resolve()}start(){this._enabled?i.ILaya.physicsTimer.clear(this,this._update):(this._enabled=!0,this._factory.start(),this.allowSleeping=e.allowSleeping,this._emptyBody=this._factory.createBody(null)),e.debugDraw?(this.enableDebugDraw=!0,this.drawShape=e.drawShape,this.drawJoint=e.drawJoint,this.drawAABB=e.drawAABB,this.drawCenterOfMass=e.drawCenterOfMass):this.enableDebugDraw=!1,this._rigiBodyList?this._rigiBodyList.clear():this._rigiBodyList=new i.SingletonList,this._updataattributeLists?this._updataattributeLists.clear():this._updataattributeLists=new i.SingletonList,!e.customUpdate&&i.LayaEnv.isPlaying&&i.ILaya.physicsTimer.frameLoop(1,this,this._update)}destroyWorld(){this._enabled=!1,this._factory.destroyWorld(),i.ILaya.physicsTimer.clear(this,this._update)}stop(){this._rigiBodyList.clear(),this._updataattributeLists.clear(),i.ILaya.physicsTimer.clear(this,this._update)}getBodyCount(){return this._factory.bodyCount}getContactCount(){return this._factory.contactCount}getJointCount(){return this._factory.jointCount}updatePhysicsByWorldRoot(){if(this.worldRoot){var t=this.worldRoot.localToGlobal(i.Point.TEMP.setTo(0,0));this._factory.shiftOrigin(-t.x,-t.y)}}}i.Laya.addInitCallback((()=>o.I.enable()));class s extends i.Component{get body(){return this._body}get type(){return this._type}set type(t){this._type=t,this._updateBodyType()}get gravityScale(){return this._gravityScale}set gravityScale(t){this._gravityScale=t,this._body&&o.I._factory.set_rigidBody_gravityScale(this._body,t)}get allowRotation(){return this._allowRotation}set allowRotation(t){this._allowRotation=t,this._body&&o.I._factory.set_rigidBody_allowRotation(this._body,!t)}get allowSleep(){return this._allowSleep}set allowSleep(t){this._allowSleep=t,this._body&&o.I._factory.set_rigidBody_allowSleep(this._body,t)}get angularDamping(){return this._angularDamping}set angularDamping(t){this._angularDamping=t,this._body&&o.I._factory.set_rigidBody_angularDamping(this._body,t)}get angularVelocity(){return this._body?o.I._factory.get_rigidBody_angularVelocity(this._body):this._angularVelocity}set angularVelocity(t){this._angularVelocity=t,"static"!=this._type&&this._body&&o.I._factory.set_rigidBody_angularVelocity(this.body,t)}get linearDamping(){return this._linearDamping}set linearDamping(t){this._linearDamping=t,this._body&&o.I._factory.set_rigidBody_linearDamping(this._body,t)}get linearVelocity(){if(this._body){var t=o.I._factory.get_rigidBody_linearVelocity(this._body);return{x:t.x,y:t.y}}return this._linearVelocity}set linearVelocity(t){if(t){if(t instanceof Array)throw new Error("set linearVelocity: value is not implement IV2");this._linearVelocity=t,"static"!=this._type&&this._body&&o.I._factory.set_rigidBody_linearVelocity(this._body,t)}}get bullet(){return this._bullet}set bullet(t){this._bullet=t,this._body&&o.I._factory.set_rigidBody_bullet(this._body,t)}set position(t){if(!this._body)return;var e=o.I._factory;let s=i.Utils.toAngle(e.get_RigidBody_Angle(this.body));e.set_RigibBody_Transform(this._body,t.x,t.y,s),e.set_rigidbody_Awake(this._body,!0),o.I._addRigidBody(this)}set rotation(t){if(this._body){var e=o.I._factory,s=i.Vector2.TEMP;e.get_RigidBody_Position(this.body,s),e.set_RigibBody_Transform(this._body,s.x,s.y,t),e.set_rigidbody_Awake(this._body,!0),o.I._addRigidBody(this)}}constructor(){super(),this._allowSleep=!0,this._angularVelocity=0,this._angularDamping=0,this._linearVelocity={x:0,y:0},this._linearDamping=0,this._bullet=!1,this._allowRotation=!0,this._gravityScale=1,this.group=0,this.category=1,this.mask=-1,this.label="RigidBody",this._type="dynamic"}_createBody(){if(this._body||!this.owner)return;let t=o.I._factory;var e=this.owner,s=new i.RigidBody2DInfo;s.position.setValue(e.globalTrans.x,e.globalTrans.y),s.angle=i.Utils.toRadian(e.globalTrans.rotation),s.allowSleep=this._allowSleep,s.angularDamping=this._angularDamping,s.bullet=this._bullet,s.fixedRotation=!this._allowRotation,s.gravityScale=this._gravityScale,s.linearDamping=this._linearDamping,s.group=this.group;var r=this._linearVelocity;s.type=this._type,"static"==this._type?(s.angularVelocity=0,s.linearVelocity.setValue(0,0)):(s.angularVelocity=this._angularVelocity,(r&&0!=r.x||0!=r.y)&&s.linearVelocity.setValue(r.x,r.y)),this._body=t.rigidBodyDef_Create(s),this._needrefeshShape()}_updateBodyType(){this._body&&(o.I._factory.set_rigidBody_type(this.body,this._type),"static"==this.type?o.I._removeRigidBody(this):o.I._addRigidBody(this))}_globalChangeHandler(t){"static"==this.type&&this._needrefeshShape()}_onAwake(){this.owner.globalTrans.cache=!0,this._createBody()}_onEnable(){this.owner.globalTrans.cache=!0,o.I._factory.set_RigibBody_Enable(this._body,!0),this._updateBodyType(),this.owner.on(i.SpriteGlobalTransform.CHANGED,this,this._globalChangeHandler)}_needrefeshShape(){o.I._updataRigidBodyAttribute(this)}_updatePhysicsAttribute(){var t=o.I._factory,e=this.owner;t.set_RigibBody_Transform(this._body,e.globalTrans.x,e.globalTrans.y,i.Utils.toRadian(this.owner.globalTrans.rotation));var s=this.owner.getComponents(r);if(s){for(var a=0,n=s.length;a<n;a++){var h=s[a];h.rigidBody=this,h._refresh()}t.retSet_rigidBody_MassData(this._body),t.set_rigidbody_Awake(this._body,!0),this.owner.event("shapeChange")}}getBody(){return this._body||this._onAwake(),this._body}_updatePhysicsTransformToRender(){if("static"!=this.type){var t=o.I._factory;if(o.I._factory.get_rigidBody_IsAwake(this._body)){var e=i.Vector2.TEMP;t.get_RigidBody_Position(this.body,e),this.owner.globalTrans.setPos(e.x,e.y),this.owner.globalTrans.rotation=i.Utils.toAngle(t.get_RigidBody_Angle(this.body))}}}_onDisable(){o.I._factory.set_RigibBody_Enable(this._body,!1),o.I._removeRigidBody(this),o.I._removeRigidBodyAttribute(this),this.owner.off(i.SpriteGlobalTransform.CHANGED,this,this._globalChangeHandler)}_onDestroy(){o.I._removeRigidBody(this),o.I._removeRigidBodyAttribute(this),this.owner.off(i.SpriteGlobalTransform.CHANGED,this,this._globalChangeHandler),this._body&&o.I._factory.removeBody(this._body),this._body=null}applyForce(t,i){this._body&&o.I._factory.rigidBody_applyForce(this._body,i,t)}applyForceToCenter(t){this._body&&o.I._factory.rigidBody_applyForceToCenter(this._body,t)}applyLinearImpulse(t,i){this._body&&o.I._factory.rigidbody_ApplyLinearImpulse(this._body,i,t)}applyLinearImpulseToCenter(t){this._body&&o.I._factory.rigidbody_ApplyLinearImpulseToCenter(this._body,t)}applyTorque(t){this._body&&o.I._factory.rigidbody_applyTorque(this._body,t)}setVelocity(t){this._body&&o.I._factory.set_rigidBody_linearVelocity(this._body,t)}setAngle(t){if(this._body){var i=o.I._factory;i.set_RigibBody_Transform(this._body,this.owner.globalTrans.x,this.owner.globalTrans.y,t),i.set_rigidbody_Awake(this._body,!0)}}getMass(){return this._body?o.I._factory.get_rigidbody_Mass(this._body):0}getCenter(){return this._body?o.I._factory.get_rigidBody_Center(this._body):null}getWorldCenter(){return this._body?o.I._factory.get_rigidBody_WorldCenter(this._body):null}getWorldPoint(t,i){return this.owner.globalTrans.localToGlobal(t,i)}getLocalPoint(t,i){return this.owner.globalTrans.globalToLocal(t,i)}}class r extends i.Component{get scaleX(){return this.owner.globalTrans.scaleX}get scaleY(){return this.owner.globalTrans.scaleY}get pivotoffx(){return this._x-this.owner.pivotX}get pivotoffy(){return this._y-this.owner.pivotY}get x(){return this._x}set x(t){this._x!=t&&(this._x=t,this._needupdataShapeAttribute())}get y(){return this._y}set y(t){this._y!=t&&(this._y=t,this._needupdataShapeAttribute())}get isSensor(){return this._isSensor}set isSensor(t){this._isSensor!=t&&(this._isSensor=t,this._needupdataShapeAttribute())}get density(){return this._density}set density(t){this._density!=t&&(this._density=t,this._needupdataShapeAttribute())}get friction(){return this._friction}set friction(t){this._friction!=t&&(this._friction=t,this._needupdataShapeAttribute())}get restitution(){return this._restitution}set restitution(t){this._restitution!=t&&(this._restitution=t,this._needupdataShapeAttribute())}constructor(){super(),this._isSensor=!1,this._density=10,this._friction=.2,this._restitution=0,this._x=0,this._y=0,this._singleton=!1}_setShapeData(t){throw"ColliderBase: must override it."}_createfixture(){let t=o.I._factory;var i=this.rigidBody.body,e=r.TempDef;e.density=this.density,e.friction=this.friction,e.isSensor=this.isSensor,e.restitution=this.restitution,e.shape=this._physicShape;let s=t.createFixtureDef(e);this._setShapeData(s._shape),this._fixture=t.createfixture(i,s)}resetFixtureData(){var t=r.TempDef;t.density=this.density,t.friction=this.friction,t.isSensor=this.isSensor,t.restitution=this.restitution,o.I._factory.resetFixtureData(this._fixture,t),this._setShapeData(this._fixture.shape)}_onEnable(){this.owner.getComponent(s)&&(this.rigidBody=this.owner.getComponent(s),this._needupdataShapeAttribute())}_onAwake(){this.owner.getComponent(s)&&(this.rigidBody=this.owner.getComponent(s),this._needupdataShapeAttribute())}_needupdataShapeAttribute(){this.rigidBody&&this.rigidBody._needrefeshShape()}_refresh(){if(!this.enabled)return;let t=o.I._factory;this._fixture?this.resetFixtureData():this._createfixture(),t.set_fixtureDef_GroupIndex(this._fixture,this.rigidBody.group),t.set_fixtureDef_CategoryBits(this._fixture,this.rigidBody.category),t.set_fixtureDef_maskBits(this._fixture,this.rigidBody.mask),t.set_fixture_collider(this._fixture,this)}_onDisable(){let t=o.I._factory;this._fixture&&this.rigidBody.body&&t.rigidBody_DestroyFixture(this.rigidBody.body,this._fixture),this._fixture=null,this.rigidBody=null}}r.TempDef=new i.FixtureBox2DDef;class a extends r{get width(){return this._width}set width(t){if(t<=0)throw"BoxCollider size cannot be less than 0";this._width!=t&&(this._width=t,this._needupdataShapeAttribute())}get height(){return this._height}set height(t){if(t<=0)throw"BoxCollider size cannot be less than 0";this._height!=t&&(this._height=t,this._needupdataShapeAttribute())}constructor(){super(),this._width=100,this._height=100,this._physicShape=i.PhysicsShape.BoxShape}_setShapeData(t){let i=.5*this._width,e=.5*this._height;var s={x:i+this.pivotoffx,y:e+this.pivotoffy};o.I._factory.set_collider_SetAsBox(t,i,e,s,Math.abs(this.scaleX),Math.abs(this.scaleY))}}class n extends r{get points(){return this._points}set points(t){if(!t)throw"ChainCollider points cannot be empty";this._points=t;var i=this._points.split(",");let e=i.length;this._datas=[];for(var o=0,s=e;o<s;o++)this._datas.push(parseInt(i[o]));this._needupdataShapeAttribute()}get datas(){return this._datas}set datas(t){if(!t)throw"ChainCollider datas cannot be empty";this._datas=t,this._needupdataShapeAttribute()}get loop(){return this._loop}set loop(t){this._loop!=t&&(this._loop=t,this._needupdataShapeAttribute())}constructor(){super(),this._points="0,0,100,0",this._datas=[],this._loop=!1,this._physicShape=i.PhysicsShape.ChainShape}_setShapeData(t){if(this._datas.length%2==1)throw"ChainCollider datas lenth must a multiplier of 2";o.I._factory.set_ChainShape_data(t,this.pivotoffx,this.pivotoffy,this._datas,this._loop,this.scaleX,this.scaleY)}onAdded(){if(super.onAdded(),0==this._datas.length){let t=this.owner;this._datas.push(0,0,t.width,0,0,t.height,t.width,t.height)}}}class h extends r{get radius(){return this._radius}set radius(t){if(t<=0)throw"CircleCollider radius cannot be less than 0";this._radius!=t&&(this._radius=t,this._needupdataShapeAttribute())}constructor(){super(),this._radius=50,this._physicShape=i.PhysicsShape.CircleShape}_setShapeData(t){var i=Math.max(Math.abs(this.scaleX),Math.abs(this.scaleY));let e=this.radius;o.I._factory.set_CircleShape_radius(t,e,i),o.I._factory.set_CircleShape_pos(t,this.x,this.y,i)}}class _ extends r{get points(){return this._points}set points(t){if(!t)throw"EdgeCollider points cannot be empty";this._points=t;var i=this._points.split(",");let e=i.length;this._datas=[];for(var o=0,s=e;o<s;o++)this._datas.push(parseInt(i[o]));this._needupdataShapeAttribute()}get datas(){return this._datas}set datas(t){if(!t)throw"EdgeCollider points cannot be empty";this._datas=t,this._needupdataShapeAttribute()}constructor(){super(),this._points="0,0,100,0",this._datas=[0,0,100,0],this._physicShape=i.PhysicsShape.EdgeShape}_setShapeData(t){if(this._datas.length%2==1)throw"EdgeCollider points lenth must a multiplier of 2";o.I._factory.set_EdgeShape_data(t,this.pivotoffx,this.pivotoffy,this._datas,this.scaleX,this.scaleY)}}class l extends r{get points(){return this._points}set points(t){if(!t)throw"PolygonCollider points cannot be empty";this._points=t;var i=this._points.split(",");let e=i.length;this._datas=[];for(var o=0,s=e;o<s;o++)this._datas.push(parseInt(i[o]));this._needupdataShapeAttribute()}get datas(){return this._datas}set datas(t){if(!t)throw"PolygonCollider points cannot be empty";this._datas=t,this._needupdataShapeAttribute()}constructor(){super(),this._points="50,0,100,100,0,100",this._datas=[50,0,100,100,0,100],this._physicShape=i.PhysicsShape.PolygonShape}_setShapeData(t){var i=this.datas.length;if(i<6)throw"PolygonCollider points must be greater than 3";if(i%2==1)throw"PolygonCollider points lenth must a multiplier of 2";o.I._factory.set_PolygonShape_data(t,this.pivotoffx,this.pivotoffy,this.datas,this.scaleX,this.scaleY)}}class d extends i.Component{get joint(){return this._joint||this._createJoint(),this._joint}constructor(){super(),this._factory=o.I._factory,this._singleton=!1}getBodyAnchor(t,e,o){i.Point.TEMP.setTo(e,o);let s=t.owner;return s&&(s.transform?s.transform.transformPointN(i.Point.TEMP):(i.Point.TEMP.x*=s.scaleX,i.Point.TEMP.y*=s.scaleY)),i.Point.TEMP}_onEnable(){this._createJoint()}_onAwake(){this._createJoint()}_createJoint(){}_onDisable(){this._joint&&this._factory.getJoint_userData(this._joint)&&!this._factory.getJoint_userData_destroy(this._joint)&&o.I._factory.removeJoint(this._joint),this._joint=null}}class y extends d{constructor(){super(...arguments),this._length=0,this._maxLength=-1,this._minLength=-1,this._frequency=1,this._dampingRatio=0,this.selfAnchor=[0,0],this.otherAnchor=[0,0],this.collideConnected=!1}get length(){return this._length}set length(t){this._length=t,this._joint&&this._factory.set_DistanceJoint_length(this._joint,t)}get minLength(){return this._minLength}set minLength(t){this._minLength=t,this._joint&&this._factory.set_DistanceJoint_MinLength(this._joint,t)}get maxLength(){return this._maxLength}set maxLength(t){this._maxLength=t,this._joint&&this._factory.set_DistanceJoint_MaxLength(this._joint,t)}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._joint&&this._factory.set_DistanceJointStiffnessDamping(this._joint,this._frequency,this._dampingRatio)}get damping(){return this._dampingRatio}set damping(t){this._dampingRatio=t,this._joint&&this._factory.set_DistanceJointStiffnessDamping(this._joint,this._frequency,this._dampingRatio)}get jointLength(){return this._joint?this._factory.phyToLayaValue(this.joint.GetLength()):0}_createJoint(){if(!this._joint){if(this.selfBody=this.selfBody||this.owner.getComponent(s),!this.selfBody)throw"selfBody can not be empty";let e=this.getBodyAnchor(this.selfBody,this.selfAnchor[0],this.selfAnchor[1]);var t=y._temp||(y._temp=new i.physics2D_DistancJointDef);t.bodyB=this.selfBody.getBody(),t.localAnchorB.setValue(e.x,e.y),this.selfBody.owner.on("shapeChange",this,this._refeahJoint),this.otherBody?(t.bodyA=this.otherBody.getBody(),e=this.getBodyAnchor(this.otherBody,this.otherAnchor[0],this.otherAnchor[1]),t.localAnchorA.setValue(e.x,e.y),this.otherBody.owner.on("shapeChange",this,this._refeahJoint)):(t.bodyA=o.I._emptyBody,t.localAnchorA.setValue(this.otherAnchor[0],this.otherAnchor[1])),t.dampingRatio=this._dampingRatio,t.frequency=this._frequency,t.collideConnected=this.collideConnected,t.length=this._length,t.maxLength=this._maxLength,t.minLength=this._minLength,this._joint=this._factory.createDistanceJoint(t)}}_refeahJoint(){this._joint&&this._factory.set_DistanceJointStiffnessDamping(this._joint,this._frequency,this._dampingRatio)}onDestroy(){super.onDestroy(),this.selfBody.owner.off("shapeChange",this._refeahJoint),this.otherBody&&this.otherBody.owner.off("shapeChange",this._refeahJoint)}}class c extends d{constructor(){super(...arguments),this._ratio=1,this.collideConnected=!1}get ratio(){return this._ratio}set ratio(t){this._ratio=t,this._joint&&this._factory.set_GearJoint_SetRatio(this._joint,t)}_createJoint(){if(!this._joint){if(!this.joint1)throw"Joint1 can not be empty";if(!this.joint2)throw"Joint2 can not be empty";var t=c._temp||(c._temp=new i.physics2D_GearJointDef);t.bodyA=this.joint1.owner.getComponent(s).getBody(),t.bodyB=this.joint2.owner.getComponent(s).getBody(),t.joint1=this.joint1.joint,t.joint2=this.joint2.joint,t.ratio=-this._ratio,t.collideConnected=this.collideConnected,this._joint=this._factory.create_GearJoint(t)}}}class g extends d{constructor(){super(...arguments),this._linearOffset=[0,0],this._angularOffset=0,this._maxForce=1e3,this._maxTorque=1e3,this._correctionFactor=.3,this.collideConnected=!1}get linearOffset(){return this._linearOffset}set linearOffset(t){this._linearOffset=t,this._joint&&this._factory.set_MotorJoint_linearOffset(this._joint,t[0],t[1])}get angularOffset(){return this._angularOffset}set angularOffset(t){this._angularOffset=t,this._joint&&this._factory.set_MotorJoint_SetAngularOffset(this._joint,i.Utils.toRadian(-t))}get maxForce(){return this._maxForce}set maxForce(t){this._maxForce=t,this._joint&&this._factory.set_MotorJoint_SetMaxForce(this._joint,t)}get maxTorque(){return this._maxTorque}set maxTorque(t){this._maxTorque=t,this._joint&&this._factory.set_MotorJoint_SetMaxTorque(this._joint,t)}get correctionFactor(){return this._correctionFactor}set correctionFactor(t){this._correctionFactor=t,this._joint&&this._factory.set_MotorJoint_SetCorrectionFactor(this._joint,t)}_createJoint(){if(!this._joint){if(!this.otherBody)throw"otherBody can not be empty";if(this.selfBody=this.selfBody||this.owner.getComponent(s),!this.selfBody)throw"selfBody can not be empty";var t=g._temp||(g._temp=new i.physics2D_MotorJointDef);t.bodyA=this.selfBody.getBody(),t.bodyB=this.otherBody.getBody(),t.linearOffset.setValue(this._linearOffset[0],this._linearOffset[1]),t.angularOffset=i.Utils.toRadian(-this._angularOffset),t.maxForce=this._maxForce,t.maxTorque=this._maxTorque,t.correctionFactor=this._correctionFactor,t.collideConnected=this.collideConnected,this._joint=this._factory.create_MotorJoint(t)}}}class p extends d{constructor(){super(...arguments),this._maxForce=1e3,this._frequency=5,this._dampingRatio=.7}get maxForce(){return this._maxForce}set maxForce(t){this._maxForce=t,this._joint&&this._factory.set_MotorJoint_SetMaxForce(this._joint,t)}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._joint&&this._factory.set_MouseJoint_frequencyAndDampingRatio(this._joint,this._frequency,this._dampingRatio)}get damping(){return this._dampingRatio}set damping(t){this._dampingRatio=t,this._joint&&this._factory.set_MouseJoint_frequencyAndDampingRatio(this._joint,this._frequency,this._dampingRatio)}_onEnable(){this.owner.on(i.Event.MOUSE_DOWN,this,this._onMouseDown)}_createJoint(){if(!this._joint){if(this.selfBody=this.selfBody||this.owner.getComponent(s),!this.selfBody)throw"selfBody can not be empty";var t=p._temp||(p._temp=new i.physics2D_MouseJointJointDef);if(this.anchor)var e=this.selfBody.owner.localToGlobal(i.Point.TEMP.setTo(this.anchor[0],this.anchor[1]),!1,o.I.worldRoot);else e=o.I.worldRoot.globalToLocal(i.Point.TEMP.setTo(i.ILaya.stage.mouseX,i.ILaya.stage.mouseY));t.bodyA=o.I._emptyBody,t.bodyB=this.selfBody.getBody(),t.target.setValue(e.x,e.y),t.maxForce=this._maxForce,t.dampingRatio=this._dampingRatio,t.frequency=this._frequency,this._factory.set_rigidbody_Awake(t.bodyB,!0),this._joint=this._factory.create_MouseJoint(t)}}_onMouseDown(){this._createJoint(),i.ILaya.stage.on(i.Event.MOUSE_MOVE,this,this._onMouseMove),i.ILaya.stage.once(i.Event.MOUSE_UP,this,this._onStageMouseUp),i.ILaya.stage.once(i.Event.MOUSE_OUT,this,this._onStageMouseUp)}_onStageMouseUp(){i.ILaya.stage.off(i.Event.MOUSE_MOVE,this,this._onMouseMove),i.ILaya.stage.off(i.Event.MOUSE_UP,this,this._onStageMouseUp),i.ILaya.stage.off(i.Event.MOUSE_OUT,this,this._onStageMouseUp),this._factory.removeJoint(this._joint),this._joint=null}_onMouseMove(){this._joint&&this._factory.set_MouseJoint_target(this._joint,o.I.worldRoot.mouseX,o.I.worldRoot.mouseY)}_onDisable(){super._onDisable(),this.owner.off(i.Event.MOUSE_DOWN,this,this._onMouseDown)}}class u extends d{constructor(){super(...arguments),this._enableMotor=!1,this._motorSpeed=0,this._maxMotorForce=1e4,this._enableLimit=!1,this._lowerTranslation=0,this._upperTranslation=0,this._axis=[1,0],this.anchor=[0,0],this.angle=0,this.collideConnected=!1}get enableMotor(){return this._enableMotor}set enableMotor(t){this._enableMotor=t,this._joint&&this._factory.set_Joint_EnableMotor(this._joint,t)}get motorSpeed(){return this._motorSpeed}set motorSpeed(t){this._motorSpeed=t,this._joint&&this._factory.set_Joint_SetMotorSpeed(this._joint,t)}get maxMotorForce(){return this._maxMotorForce}set maxMotorForce(t){this._maxMotorForce=t,this._joint&&this._factory.set_Joint_SetMaxMotorTorque(this._joint,t)}get enableLimit(){return this._enableLimit}set enableLimit(t){this._enableLimit=t,this._joint&&this._factory.set_Joint_EnableLimit(this._joint,t)}get lowerTranslation(){return this._lowerTranslation}set lowerTranslation(t){this._lowerTranslation=t,this._joint&&this._factory.set_Joint_SetLimits(this._joint,t,this._upperTranslation)}get upperTranslation(){return this._upperTranslation}set upperTranslation(t){this._upperTranslation=t,this._joint&&this._factory.set_Joint_SetLimits(this._joint,this._lowerTranslation,t)}get axis(){return this._axis}set axis(t){this._axis=t,this.angle=i.Utils.toAngle(Math.atan2(t[1],t[0]))}_createJoint(){if(!this._joint){if(this.selfBody=this.selfBody||this.owner.getComponent(s),!this.selfBody)throw"selfBody can not be empty";var t=u._temp||(u._temp=new i.physics2D_PrismaticJointDef);t.bodyB=this.selfBody.getBody(),t.bodyA=this.otherBody?this.otherBody.getBody():o.I._emptyBody;let e=this.selfBody.getWorldPoint(this.anchor[0],this.anchor[1]);t.anchor.setValue(e.x,e.y);let r=i.Utils.toRadian(this.angle);t.axis.setValue(Math.cos(r),Math.sin(r)),t.enableMotor=this._enableMotor,t.motorSpeed=this._motorSpeed,t.maxMotorForce=this._maxMotorForce,t.enableLimit=this._enableLimit,t.lowerTranslation=this._lowerTranslation,t.upperTranslation=this._upperTranslation,t.collideConnected=this.collideConnected,this._joint=this._factory.create_PrismaticJoint(t)}}}class f extends d{constructor(){super(...arguments),this.selfAnchor=[0,0],this.otherAnchor=[0,0],this.selfGroundPoint=[0,-100],this.otherGroundPoint=[0,-100],this.ratio=1,this.collideConnected=!1}_createJoint(){if(!this._joint){if(!this.otherBody)throw"otherBody can not be empty";if(this.selfBody=this.selfBody||this.owner.getComponent(s),!this.selfBody)throw"selfBody can not be empty";var t=f._temp||(f._temp=new i.physics2D_PulleyJointDef);t.bodyA=this.otherBody.getBody(),t.bodyB=this.selfBody.getBody();var e=this.otherBody.getWorldPoint(this.otherAnchor[0],this.otherAnchor[1]);t.localAnchorA.setValue(e.x,e.y);var r=this.selfBody.getWorldPoint(this.selfAnchor[0],this.selfAnchor[1]);t.localAnchorB.setValue(r.x,r.y);var a=this.otherBody.getWorldPoint(this.otherGroundPoint[0],this.otherGroundPoint[1]);t.groundAnchorA.setValue(a.x,a.y);var n=this.selfBody.getWorldPoint(this.selfGroundPoint[0],this.selfGroundPoint[1]);t.groundAnchorB.setValue(n.x,n.y),t.ratio=this.ratio,t.collideConnected=this.collideConnected,this._joint=o.I._factory.create_PulleyJoint(t)}}}class m extends d{constructor(){super(...arguments),this._enableMotor=!1,this._motorSpeed=0,this._maxMotorTorque=1e4,this._enableLimit=!1,this._lowerAngle=0,this._upperAngle=0,this.anchor=[0,0],this.collideConnected=!1}get enableMotor(){return this._enableMotor}set enableMotor(t){this._enableMotor=t,this._joint&&this._factory.set_Joint_EnableMotor(this._joint,t)}get motorSpeed(){return this._motorSpeed}set motorSpeed(t){this._motorSpeed=t,this._joint&&this._factory.set_Joint_SetMotorSpeed(this._joint,t)}get maxMotorTorque(){return this._maxMotorTorque}set maxMotorTorque(t){this._maxMotorTorque=t,this._joint&&this._factory.set_Joint_SetMaxMotorTorque(this._joint,t)}get enableLimit(){return this._enableLimit}set enableLimit(t){this._enableLimit=t,this._joint&&this._factory.set_Joint_EnableLimit(this._joint,t)}get lowerAngle(){return this._lowerAngle}set lowerAngle(t){this._lowerAngle=t,this._joint&&this._factory.set_Joint_SetLimits(this._joint,i.Utils.toRadian(t),i.Utils.toRadian(this._upperAngle))}get upperAngle(){return this._upperAngle}set upperAngle(t){this._upperAngle=t,this._joint&&this._factory.set_Joint_SetLimits(this._joint,i.Utils.toRadian(this._lowerAngle),i.Utils.toRadian(t))}_createJoint(){if(!this._joint){if(this.selfBody=this.selfBody||this.owner.getComponent(s),!this.selfBody)throw"selfBody can not be empty";var t=m._temp||(m._temp=new i.physics2D_RevoluteJointDef);t.bodyB=this.selfBody.getBody(),t.bodyA=this.otherBody?this.otherBody.getBody():o.I._emptyBody;let e=this.selfBody.getWorldPoint(this.anchor[0],this.anchor[1]);t.anchor.setValue(e.x,e.y),t.enableMotor=this._enableMotor,t.motorSpeed=this._motorSpeed,t.maxMotorTorque=this._maxMotorTorque,t.enableLimit=this._enableLimit,t.lowerAngle=i.Utils.toRadian(this._lowerAngle),t.upperAngle=i.Utils.toRadian(this._upperAngle),t.collideConnected=this.collideConnected,this._joint=this._factory.create_RevoluteJoint(t)}}}class b extends d{constructor(){super(...arguments),this._frequency=5,this._dampingRatio=.7,this.anchor=[0,0],this.collideConnected=!1}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._joint&&this._factory.set_Joint_frequencyAndDampingRatio(this._joint,this._frequency,this._dampingRatio,!1)}get damping(){return this._dampingRatio}set damping(t){this._dampingRatio=t,this._joint&&this._factory.set_Joint_frequencyAndDampingRatio(this._joint,this._frequency,this._dampingRatio,!0)}_createJoint(){if(!this._joint){if(!this.otherBody)throw"otherBody can not be empty";if(this.selfBody=this.selfBody||this.owner.getComponent(s),!this.selfBody)throw"selfBody can not be empty";var t=b._temp||(b._temp=new i.physics2D_WeldJointDef),e=this.selfBody.getWorldPoint(this.anchor[0],this.anchor[1]);t.bodyA=this.otherBody.getBody(),t.bodyB=this.selfBody.getBody(),t.anchor.setValue(e.x,e.y),t.frequency=this._frequency,t.dampingRatio=this._dampingRatio,t.collideConnected=this.collideConnected,this._joint=this._factory.create_WeldJoint(t)}}}class B extends d{constructor(){super(...arguments),this._frequency=1,this._dampingRatio=.7,this._enableMotor=!1,this._motorSpeed=0,this._maxMotorTorque=1e4,this._enableLimit=!0,this._lowerTranslation=0,this._upperTranslation=0,this.anchor=[0,0],this.collideConnected=!1,this._axis=[0,1],this.angle=90}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._joint&&this._factory.set_Joint_frequencyAndDampingRatio(this._joint,this._frequency,this._dampingRatio,!1)}get damping(){return this._dampingRatio}set damping(t){this._dampingRatio=t,this._joint&&this._factory.set_Joint_frequencyAndDampingRatio(this._joint,this._frequency,this._dampingRatio,!0)}get enableMotor(){return this._enableMotor}set enableMotor(t){this._enableMotor=t,this._joint&&this._factory.set_Joint_EnableMotor(this._joint,t)}get motorSpeed(){return this._motorSpeed}set motorSpeed(t){this._motorSpeed=t,this._joint&&this._factory.set_Joint_SetMotorSpeed(this._joint,t)}get maxMotorTorque(){return this._maxMotorTorque}set maxMotorTorque(t){this._maxMotorTorque=t,this._joint&&this._factory.set_Joint_SetMaxMotorTorque(this._joint,t)}get enableLimit(){return this._enableLimit}set enableLimit(t){this._enableLimit=t,this._joint&&this._factory.set_Joint_EnableLimit(this._joint,t)}get lowerTranslation(){return this._lowerTranslation}set lowerTranslation(t){this._lowerTranslation=t,this._joint&&this._factory.set_Joint_SetLimits(this._joint,t,this._upperTranslation)}get upperTranslation(){return this._upperTranslation}set upperTranslation(t){this._upperTranslation=t,this._joint&&this._factory.set_Joint_SetLimits(this._joint,this._lowerTranslation,t)}get axis(){return this._axis}set axis(t){this._axis=t,this.angle=i.Utils.toAngle(Math.atan2(t[1],t[0]))}_createJoint(){if(!this._joint){if(!this.otherBody)throw"otherBody can not be empty";if(this.selfBody=this.selfBody||this.owner.getComponent(s),!this.selfBody)throw"selfBody can not be empty";var t=B._temp||(B._temp=new i.physics2D_WheelJointDef),e=this.selfBody.getWorldPoint(this.anchor[0],this.anchor[1]);t.anchor.setValue(e.x,e.y);let o=i.Utils.toRadian(this.angle);t.axis.setValue(Math.cos(o),Math.sin(o)),t.bodyA=this.otherBody.getBody(),t.bodyB=this.selfBody.getBody(),t.enableMotor=this._enableMotor,t.motorSpeed=this._motorSpeed,t.maxMotorTorque=this._maxMotorTorque,t.collideConnected=this.collideConnected,t.enableLimit=this._enableLimit,t.lowerTranslation=this._lowerTranslation,t.upperTranslation=this._upperTranslation,t.frequency=this._frequency,t.dampingRatio=this._dampingRatio,this._joint=this._factory.create_WheelJoint(t)}}}class w extends i.Sprite{get mG(){return this._mG}get textG(){return this._textG}get lineWidth(){return this._lineWidth}get camera(){return this._camera}constructor(t){super(),this._factory=t,this.DrawString_color="#E69999",this.Red="#ff0000",this.Green="#00ff00",this._camera={},this._camera.m_center=new i.Vector2(0,0),this._camera.m_extent=25,this._camera.m_zoom=1,this._camera.m_width=1280,this._camera.m_height=800,this._mG=new i.Graphics,this.graphics=this._mG,this._textSp=new i.Sprite,this._textG=this._textSp.graphics,this.addChild(this._textSp)}_renderToGraphic(){this._factory.world&&(this._textG.clear(),this._mG.clear(),this._mG.save(),this._mG.scale(this._factory.PIXEL_RATIO,this._factory.PIXEL_RATIO),this._lineWidth=this._factory.layaToPhyValue(1),this._factory.world.DebugDraw?this._factory.world.DebugDraw():this._factory.world.DrawDebugData(),this._mG.restore())}render(t,e,o){i.LayaEnv.isPlaying&&(this._renderToGraphic(),super.render(t,e,o))}PushTransform(t,i,e){this._mG.save(),this._mG.translate(t,i),this._mG.rotate(e)}PopTransform(){this._mG.restore()}}let x=i.ClassUtils.regClass;x("Physics2D",o),x("Physics2DDebugDraw",w),x("ColliderBase",r),x("BoxCollider",a),x("ChainCollider",n),x("CircleCollider",h),x("EdgeCollider",_),x("PolygonCollider",l),x("RigidBody",s),x("JointBase",d),x("DistanceJoint",y),x("GearJoint",c),x("MotorJoint",g),x("MouseJoint",p),x("PrismaticJoint",u),x("PulleyJoint",f),x("RevoluteJoint",m),x("WeldJoint",b),x("WheelJoint",B),t.BoxCollider=a,t.ChainCollider=n,t.CircleCollider=h,t.ColliderBase=r,t.DistanceJoint=y,t.EdgeCollider=_,t.GearJoint=c,t.JointBase=d,t.MotorJoint=g,t.MouseJoint=p,t.Physics2D=o,t.Physics2DDebugDraw=w,t.Physics2DOption=e,t.PolygonCollider=l,t.PrismaticJoint=u,t.PulleyJoint=f,t.RevoluteJoint=m,t.RigidBody=s,t.WeldJoint=b,t.WheelJoint=B}(window.Laya=window.Laya||{},Laya);