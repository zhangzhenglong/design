<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>个性化营养方案 - NutriLife</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'PingFang SC', 'Helvetica Neue', Arial, sans-serif;
        }
        
        body {
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 480px;
            margin: 0 auto;
            padding: 0;
            background: #fff;
            min-height: 100vh;
            position: relative;
        }
        
        .header {
            background: linear-gradient(135deg, #4CAF50, #8BC34A);
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 0 0 15px 15px;
            margin-bottom: 20px;
        }
        
        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        .header p {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .nav-tabs {
            display: flex;
            justify-content: space-around;
            background: white;
            padding: 15px 0;
            border-radius: 10px;
            margin: 0 15px 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .nav-tab {
            text-align: center;
            padding: 10px 0;
            width: 25%;
            font-size: 12px;
            color: #666;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .nav-tab.active {
            color: #4CAF50;
            font-weight: bold;
        }
        
        .nav-tab i {
            display: block;
            font-size: 20px;
            margin-bottom: 5px;
        }
        
        .content {
            padding: 0 20px 80px;
        }
        
        .section {
            display: none;
        }
        
        .section.active {
            display: block;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .card-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }
        
        .btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            width: 100%;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #3d8b40;
        }
        
        .btn-outline {
            background: transparent;
            border: 1px solid #4CAF50;
            color: #4CAF50;
        }
        
        .btn-outline:hover {
            background: rgba(76, 175, 80, 0.1);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border 0.3s;
        }
        
        .form-control:focus {
            border-color: #4CAF50;
            outline: none;
        }
        
        .radio-group, .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .radio-item, .checkbox-item {
            flex: 1 0 45%;
            background: #f5f5f5;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .radio-item.selected, .checkbox-item.selected {
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid #4CAF50;
        }
        
        .progress-container {
            margin: 30px 0;
        }
        
        .progress-bar {
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background: #4CAF50;
            border-radius: 4px;
            transition: width 0.5s;
        }
        
        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: #666;
        }
        
        .plan-card {
            background: white;
            border-radius: 15px;
            margin-bottom: 15px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .plan-header {
            background: #f5f5f5;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .plan-title {
            font-weight: 600;
            font-size: 16px;
        }
        
        .plan-body {
            padding: 15px;
            display: none;
        }
        
        .plan-body.active {
            display: block;
        }
        
        .plan-item {
            display: flex;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        
        .plan-item:last-child {
            border-bottom: none;
        }
        
        .plan-item-check {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 2px solid #ddd;
            margin-right: 15px;
            position: relative;
        }
        
        .plan-item-check.completed {
            border-color: #4CAF50;
            background: #4CAF50;
        }
        
        .plan-item-check.completed:after {
            content: '';
            position: absolute;
            top: 6px;
            left: 5px;
            width: 10px;
            height: 5px;
            border-left: 2px solid white;
            border-bottom: 2px solid white;
            transform: rotate(-45deg);
        }
        
        .plan-item-content {
            flex: 1;
        }
        
        .plan-item-title {
            font-weight: 500;
            margin-bottom: 3px;
        }
        
        .plan-item-desc {
            font-size: 14px;
            color: #666;
        }
        
        .meal-log-card {
            display: flex;
            background: white;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .meal-log-img {
            width: 80px;
            height: 80px;
            background: #eee;
            border-radius: 10px;
            margin-right: 15px;
        }
        
        .meal-log-content {
            flex: 1;
        }
        
        .meal-log-time {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .meal-log-title {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .meal-log-nutrition {
            display: flex;
            gap: 10px;
        }
        
        .nutrition-item {
            background: #f5f5f5;
            border-radius: 15px;
            padding: 5px 10px;
            font-size: 12px;
        }
        
        .report-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .report-title {
            font-size: 18px;
            font-weight: 600;
        }
        
        .report-date {
            font-size: 14px;
            color: #666;
        }
        
        .report-stat {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .stat-item {
            text-align: center;
            flex: 1;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 600;
            color: #4CAF50;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 12px;
            color: #666;
        }
        
        .chart-container {
            height: 200px;
            margin-bottom: 20px;
            background: #f5f5f5;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .chart-placeholder {
            color: #999;
            font-size: 14px;
        }
        
        /* AI模块样式 */
        .ai-module {
            display: none;
        }
        
        /* 响应式调整 */
        @media (max-width: 480px) {
            .container {
                width: 100%;
            }
            
            .radio-item, .checkbox-item {
                flex: 1 0 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 头部 -->
        <div class="header">
            <h1>NutriLife</h1>
            <p>个性化营养方案，健康生活每一天</p>
        </div>
        
        <!-- 导航栏 -->
        <div class="nav-tabs">
            <div class="nav-tab active" data-tab="questionnaire">
                <i>📋</i>
                问卷
            </div>
            <div class="nav-tab" data-tab="plan">
                <i>📊</i>
                方案
            </div>
            <div class="nav-tab" data-tab="record">
                <i>📝</i>
                记录
            </div>
            <div class="nav-tab" data-tab="report">
                <i>📈</i>
                报告
            </div>
        </div>
        
        <!-- 内容区域 -->
        <div class="content">
            <!-- 问卷部分 -->
            <div class="section active" id="questionnaire">
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 20%;"></div>
                    </div>
                    <div class="progress-text">
                        <span>问卷进度</span>
                        <span>1/5</span>
                    </div>
                </div>
                
                <div class="card">
                    <h2 class="card-title">基本信息</h2>
                    <div class="form-group">
                        <label class="form-label">性别</label>
                        <div class="radio-group">
                            <div class="radio-item selected">男</div>
                            <div class="radio-item">女</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">年龄</label>
                        <input type="number" class="form-control" placeholder="请输入您的年龄">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">身高 (cm)</label>
                        <input type="number" class="form-control" placeholder="请输入您的身高">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">体重 (kg)</label>
                        <input type="number" class="form-control" placeholder="请输入您的体重">
                    </div>
                    
                    <button class="btn" id="next-btn">下一步</button>
                </div>
                
                <div class="survey-section" id="section-5" style="display: none;">
                    <h3>活动水平</h3>
                    <div class="form-group">
                        <label>您的日常活动水平如何？</label>
                        <select class="form-control" id="activity-level">
                            <option value="sedentary">久坐不动（几乎不运动）</option>
                            <option value="light">轻度活动（每周1-3次轻度运动）</option>
                            <option value="moderate">中度活动（每周3-5次中等强度运动）</option>
                            <option value="active">活跃（每周6-7次运动）</option>
                            <option value="very-active">非常活跃（每天高强度运动或体力劳动）</option>
                        </select>
                    </div>
                    <button class="btn btn-primary next-btn">下一步</button>
                </div>
                
                <div class="survey-section" id="section-6" style="display: none;">
                    <h3>睡眠规律</h3>
                    <div class="form-group">
                        <label>您通常几点入睡？</label>
                        <input type="time" class="form-control" id="sleep-time" value="22:30">
                    </div>
                    <div class="form-group">
                        <label>您通常几点起床？</label>
                        <input type="time" class="form-control" id="wake-time" value="07:00">
                    </div>
                    <div class="form-group">
                        <label>您的睡眠质量如何？</label>
                        <select class="form-control" id="sleep-quality">
                            <option value="excellent">非常好</option>
                            <option value="good">良好</option>
                            <option value="average" selected>一般</option>
                            <option value="poor">较差</option>
                            <option value="very-poor">非常差</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>您是否有午休习惯？</label>
                        <select class="form-control" id="nap-habit">
                            <option value="no">没有</option>
                            <option value="sometimes">偶尔</option>
                            <option value="often">经常</option>
                            <option value="always">每天都有</option>
                        </select>
                    </div>
                    <button class="btn btn-primary next-btn">下一步</button>
                </div>
                
                <div class="survey-section" id="section-7" style="display: none;">
                    <h3>日常安排</h3>
                    <div class="form-group">
                        <label>您的工作/学习时间是？</label>
                        <div class="row">
                            <div class="col-6">
                                <input type="time" class="form-control" id="work-start-time" value="09:00" placeholder="开始时间">
                            </div>
                            <div class="col-6">
                                <input type="time" class="form-control" id="work-end-time" value="18:00" placeholder="结束时间">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>您通常几点吃早餐？</label>
                        <input type="time" class="form-control" id="breakfast-time" value="07:30">
                    </div>
                    <div class="form-group">
                        <label>您通常几点吃午餐？</label>
                        <input type="time" class="form-control" id="lunch-time" value="12:00">
                    </div>
                    <div class="form-group">
                        <label>您通常几点吃晚餐？</label>
                        <input type="time" class="form-control" id="dinner-time" value="18:30">
                    </div>
                    <div class="form-group">
                        <label>您是否有固定的运动时间？</label>
                        <select class="form-control" id="exercise-time-fixed">
                            <option value="no">没有固定时间</option>
                            <option value="morning">早上</option>
                            <option value="noon">中午</option>
                            <option value="afternoon">下午</option>
                            <option value="evening">晚上</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" id="submit-survey">提交问卷</button>
                </div>
            </div>
            
            <!-- 方案部分 -->
            <div class="section" id="plan">
                <div class="card">
                    <h2 class="card-title">您的个性化营养方案</h2>
                    <p>根据您的信息，我们为您制定了以下营养方案：</p>
                </div>
                
                <div class="plan-card">
                    <div class="plan-header">
                        <div class="plan-title">每日饮食建议</div>
                        <div class="plan-toggle">▼</div>
                    </div>
                    <div class="plan-body active">
                        <div class="plan-item">
                            <div class="plan-item-check completed"></div>
                            <div class="plan-item-content">
                                <div class="plan-item-title">增加蛋白质摄入</div>
                                <div class="plan-item-desc">每天摄入至少1.5g/kg体重的优质蛋白质，如鸡胸肉、鱼、豆腐等</div>
                            </div>
                        </div>
                        <div class="plan-item">
                            <div class="plan-item-check"></div>
                            <div class="plan-item-content">
                                <div class="plan-item-title">控制碳水化合物</div>
                                <div class="plan-item-desc">选择全谷物，减少精制碳水，每餐碳水不超过拳头大小</div>
                            </div>
                        </div>
                        <div class="plan-item">
                            <div class="plan-item-check"></div>
                            <div class="plan-item-content">
                                <div class="plan-item-title">补充健康脂肪</div>
                                <div class="plan-item-desc">适量食用坚果、橄榄油、牛油果等含有不饱和脂肪酸的食物</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="plan-card">
                    <div class="plan-header">
                        <div class="plan-title">运动建议</div>
                        <div class="plan-toggle">▼</div>
                    </div>
                    <div class="plan-body">
                        <div class="plan-item">
                            <div class="plan-item-check"></div>
                            <div class="plan-item-content">
                                <div class="plan-item-title">有氧运动</div>
                                <div class="plan-item-desc">每周3-5次，每次30-45分钟的中等强度有氧运动</div>
                            </div>
                        </div>
                        <div class="plan-item">
                            <div class="plan-item-check"></div>
                            <div class="plan-item-content">
                                <div class="plan-item-title">力量训练</div>
                                <div class="plan-item-desc">每周2-3次，针对主要肌群的力量训练</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="plan-card">
                    <div class="plan-header">
                        <div class="plan-title">生活习惯调整</div>
                        <div class="plan-toggle">▼</div>
                    </div>
                    <div class="plan-body">
                        <div class="plan-item">
                            <div class="plan-item-check"></div>
                            <div class="plan-item-content">
                                <div class="plan-item-title">规律作息</div>
                                <div class="plan-item-desc">保持每晚7-8小时的充足睡眠，固定睡眠时间</div>
                            </div>
                        </div>
                        <div class="plan-item">
                            <div class="plan-item-check"></div>
                            <div class="plan-item-content">
                                <div class="plan-item-title">减少压力</div>
                                <div class="plan-item-desc">每天进行15-20分钟的冥想或深呼吸练习</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <button class="btn" id="update-plan-btn">调整方案</button>
                    <button class="btn btn-outline" style="margin-top: 10px;">导出方案</button>
                </div>
            </div>
            
            <!-- 记录部分 -->
            <div class="section" id="record">
                <div class="card">
                    <h2 class="card-title">今日记录</h2>
                    <button class="btn">添加饮食记录</button>
                </div>
                
                <div class="meal-log-card">
                    <div class="meal-log-img"></div>
                    <div class="meal-log-content">
                        <div class="meal-log-time">早餐 · 08:30</div>
                        <div class="meal-log-title">全麦面包配鸡蛋</div>
                        <div class="meal-log-nutrition">
                            <div class="nutrition-item">蛋白质 15g</div>
                            <div class="nutrition-item">碳水 30g</div>
                        </div>
                    </div>
                </div>
                
                <div class="meal-log-card">
                    <div class="meal-log-img"></div>
                    <div class="meal-log-content">
                        <div class="meal-log-time">午餐 · 12:30</div>
                        <div class="meal-log-title">鸡胸肉沙拉</div>
                        <div class="meal-log-nutrition">
                            <div class="nutrition-item">蛋白质 25g</div>
                            <div class="nutrition-item">碳水 15g</div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <h2 class="card-title">运动记录</h2>
                    <button class="btn">添加运动记录</button>
                </div>
                
                <div class="meal-log-card">
                    <div class="meal-log-img"></div>
                    <div class="meal-log-content">
                        <div class="meal-log-time">17:30 · 45分钟</div>
                        <div class="meal-log-title">慢跑</div>
                        <div class="meal-log-nutrition">
                            <div class="nutrition-item">消耗 320千卡</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 报告部分 -->
            <div class="section" id="report">
                <div class="report-card">
                    <div class="report-header">
                        <div class="report-title">周报告</div>
                        <div class="report-date">2023/10/23 - 2023/10/29</div>
                    </div>
                    
                    <div class="report-stat">
                        <div class="stat-item">
                            <div class="stat-value">85%</div>
                            <div class="stat-label">方案完成率</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">-0.8kg</div>
                            <div class="stat-label">体重变化</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">4.5</div>
                            <div class="stat-label">平均评分</div>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <div class="chart-placeholder">营养摄入趋势图</div>
                    </div>
                    
                    <div class="card-title">本周总结</div>
                    <p>您本周的饮食计划执行得很好，特别是增加了蛋白质的摄入，对肌肉恢复有很大帮助。建议下周可以适当增加一些健康脂肪的摄入，如坚果和橄榄油。</p>
                </div>
                
                <div class="report-card">
                    <div class="report-header">
                        <div class="report-title">月度报告</div>
                        <div class="report-date">2023/10</div>
                    </div>
                    
                    <div class="report-stat">
                        <div class="stat-item">
                            <div class="stat-value">78%</div>
                            <div class="stat-label">方案完成率</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">-2.5kg</div>
                            <div class="stat-label">体重变化</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">+2.1%</div>
                            <div class="stat-label">肌肉增长</div>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <div class="chart-placeholder">月度进度图表</div>
                    </div>
                    
                    <div class="card-title">月度总结</div>
                    <p>恭喜您完成了本月的健康目标！您的体重下降了2.5kg，同时肌肉量增加了2.1%，这是非常健康的身体变化。建议下个月可以适当增加力量训练的强度，进一步提升代谢水平。</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- AI模块 (独立模块，方便替换) -->
    <div class="ai-module" id="ai-module">
        <!-- 这里是AI相关的代码，可以根据需要替换为其他AI模型 -->
    </div>
    
    <!-- 引入NutriLifeAI模块 -->
    <script src="js/ai-module.js"></script>
    
    <script>
        // 导航切换
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // 移除所有active类
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                
                // 添加active类到当前tab
                this.classList.add('active');
                
                // 显示对应的section
                const tabId = this.getAttribute('data-tab');
                document.getElementById(tabId).classList.add('active');
            });
        });
        
        // 方案展开/收起
        document.querySelectorAll('.plan-header').forEach(header => {
            header.addEventListener('click', function() {
                const body = this.nextElementSibling;
                body.classList.toggle('active');
                
                // 更改箭头方向
                const toggle = this.querySelector('.plan-toggle');
                toggle.textContent = body.classList.contains('active') ? '▼' : '►';
            });
        });
        
        // 初始化NutriLifeAI模块
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化AI模块
            NutriLifeAI.init({
                apiKey: '' // 需要在实际使用时设置API Key
            });
            
            console.log('NutriLife应用已初始化');
        });
        
        // 问卷处理逻辑
        let currentSection = 1;
        
        // 下一步按钮点击事件
        document.querySelectorAll('.next-btn').forEach(button => {
            button.addEventListener('click', function() {
                // 隐藏当前部分
                document.getElementById(`section-${currentSection}`).style.display = 'none';
                
                // 显示下一部分
                currentSection++;
                document.getElementById(`section-${currentSection}`).style.display = 'block';
            });
        });
        
        // 提交问卷按钮点击事件
        document.getElementById('submit-survey').addEventListener('click', function() {
            // 收集问卷数据
            const userData = {
                basicInfo: {
                    age: document.getElementById('age').value,
                    gender: document.getElementById('gender').value,
                    height: document.getElementById('height').value,
                    weight: document.getElementById('weight').value
                },
                dietaryPreferences: {
                    preferredFoods: document.getElementById('preferred-foods').value.split(','),
                    dislikedFoods: document.getElementById('disliked-foods').value.split(','),
                    cuisinePreference: document.getElementById('cuisine-preference').value
                },
                healthGoals: {
                    primaryGoal: document.getElementById('primary-goal').value,
                    targetWeight: document.getElementById('target-weight').value,
                    timeframe: document.getElementById('timeframe').value
                },
                restrictions: {
                    allergies: document.getElementById('allergies').value.split(','),
                    medicalConditions: document.getElementById('medical-conditions').value.split(','),
                    dietaryRestrictions: document.getElementById('dietary-restrictions').value
                },
                activityLevel: {
                    exerciseFrequency: document.getElementById('exercise-frequency').value,
                    exerciseIntensity: document.getElementById('exercise-intensity').value,
                    exerciseType: document.getElementById('exercise-type').value,
                    activityLevel: document.getElementById('activity-level').value
                },
                sleepPattern: {
                    sleepTime: document.getElementById('sleep-time').value,
                    wakeTime: document.getElementById('wake-time').value,
                    sleepQuality: document.getElementById('sleep-quality').value,
                    napHabit: document.getElementById('nap-habit').value
                },
                dailySchedule: {
                    workStartTime: document.getElementById('work-start-time').value,
                    workEndTime: document.getElementById('work-end-time').value,
                    breakfastTime: document.getElementById('breakfast-time').value,
                    lunchTime: document.getElementById('lunch-time').value,
                    dinnerTime: document.getElementById('dinner-time').value,
                    exerciseTimePreference: document.getElementById('exercise-time-fixed').value
                }
            };
            
            // 问卷下一步按钮
            document.getElementById('next-btn').addEventListener('click', function() {
                // 获取当前问卷步骤
                const currentStep = parseInt(document.querySelector('.progress-text span:last-child').textContent.split('/')[0]);
                const nextStep = currentStep + 1;
                
                // 获取表单数据
                const formData = {};
                if (currentStep === 1) {
                    // 基本信息
                    formData.gender = document.querySelector('.radio-item.selected').textContent.trim();
                    formData.age = document.querySelector('input[placeholder="请输入您的年龄"]').value;
                    formData.height = document.querySelector('input[placeholder="请输入您的身高"]').value;
                    formData.weight = document.querySelector('input[placeholder="请输入您的体重"]').value;
                    
                    // 更新用户基本信息
                    NutriLifeAI.updateBasicInfo(formData);
                }
                
                // 更新进度
                document.querySelector('.progress-fill').style.width = `${nextStep * 20}%`;
                document.querySelector('.progress-text span:last-child').textContent = `${nextStep}/5`;
                
                // 使用AI生成下一步问题
                NutriLifeAI.generateQuestions(nextStep).then(questions => {
                    // 这里可以根据AI返回的问题更新问卷内容
                    console.log('AI生成的问题:', questions);
                    alert(`问卷进入第${nextStep}步！\n\nAI生成的问题示例:\n${questions.substring(0, 100)}...`);
                }).catch(error => {
                    console.error('生成问题失败:', error);
                    alert('生成问题失败，请稍后再试');
                });
            });
        });
        
        // 计划项目完成状态切换
        document.querySelectorAll('.plan-item-check').forEach(check => {
            check.addEventListener('click', function() {
                this.classList.toggle('completed');
                
                // 这里可以添加完成后的奖励或鼓励信息
                if(this.classList.contains('completed')) {
                    alert('太棒了！您完成了一项计划。继续保持！');
                }
            });
        });
        
        // 添加饮食记录按钮
        document.querySelector('#record .btn').addEventListener('click', function() {
            // 模拟添加饮食记录
            const mealData = {
                type: '午餐',
                time: new Date().toLocaleTimeString(),
                food: '鸡胸肉沙拉',
                nutrition: {
                    protein: 25,
                    carbs: 15,
                    fat: 10
                },
                mood: '精力充沛',
                hunger: '适中',
                location: '家里',
                companions: '独自一人'
            };
            
            // 使用AI分析饮食记录
            NutriLifeAI.analyzeMealLog(mealData).then(analysis => {
                console.log('AI分析结果:', analysis);
                alert(`饮食分析:\n${analysis.substring(0, 150)}...`);
            }).catch(error => {
                console.error('分析饮食记录失败:', error);
                alert('分析饮食记录失败，请稍后再试');
            });
        });
        
        // 调整方案按钮
        document.getElementById('update-plan-btn').addEventListener('click', function() {
            // 模拟用户进度数据
            const userProgress = {
                weightChange: -0.5,
                completionRate: 80,
                challenges: ['控制晚餐碳水摄入', '增加蛋白质摄入'],
                achievements: ['坚持每周3次有氧运动', '增加了水果蔬菜摄入'],
                sleepQualityChange: '改善',
                energyLevelChange: '提高',
                moodChange: '更稳定',
                scheduleChanges: {
                    workHoursChanged: true,
                    newWakeTime: '06:30',
                    newSleepTime: '22:30'
                }
            };
            
            // 显示加载提示
            this.textContent = '正在调整...';
            this.disabled = true;
            
            // 使用AI更新方案
            NutriLifeAI.updatePlan(userProgress).then(updatedPlan => {
                console.log('更新后的方案:', updatedPlan);
                
                // 恢复按钮状态
                this.textContent = '调整方案';
                this.disabled = false;
                
                // 显示更新后的方案
                alert(`方案已更新！\n\n${updatedPlan.substring(0, 200)}...`);
                
                // 这里可以根据返回的方案更新UI
                // 实际应用中应该解析返回的方案并更新DOM元素
            }).catch(error => {
                console.error('更新方案失败:', error);
                alert('更新方案失败，请稍后再试');
                
                // 恢复按钮状态
                this.textContent = '调整方案';
                this.disabled = false;
            });
        });
        
        // 使用NutriLifeAI替代原有的aiModule
        window.aiModule = {
            // 分析用户问卷数据并生成方案
            analyzeSurvey: function(userData) {
                // 更新用户数据
                NutriLifeAI.updateBasicInfo(userData.basicInfo);
                NutriLifeAI.updateDietaryPreferences(userData.dietaryPreferences);
                NutriLifeAI.updateHealthGoals(userData.healthGoals);
                NutriLifeAI.updateRestrictions(userData.restrictions);
                NutriLifeAI.updateActivityLevel(userData.activityLevel);
                NutriLifeAI.updateSleepPattern(userData.sleepPattern);
                NutriLifeAI.updateDailySchedule(userData.dailySchedule);
                
                return NutriLifeAI.analyzeSurvey();
            },
            
            // 分析用户的饮食记录并给出建议
            analyzeMealLog: function(mealData) {
                return NutriLifeAI.analyzeMealLog(mealData);
            },
            
            // 分析用户的运动记录并给出建议
            analyzeExerciseLog: function(exerciseData) {
                return NutriLifeAI.analyzeExerciseLog(exerciseData);
            },
            
            // 生成周期性报告
            generateReport: function(userRecords) {
                return NutriLifeAI.generateReport(userRecords);
            },
            
            // 更新用户的营养方案
            updatePlan: function(userProgress) {
                return NutriLifeAI.updatePlan(userProgress);
            }
        };

    </script>
</body>
</html>