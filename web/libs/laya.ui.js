!function(t,e){"use strict";class s{}s.touchScrollEnable=!0,s.mouseWheelEnable=!0,s.showButtons=!0,s.popupBgColor="#000000",s.popupBgAlpha=.5,s.closeDialogOnSide=!0;class i extends e.Graphics{constructor(){super(...arguments),this._width=null,this._height=null,this._color="#ffffff",this.uv=null}get sizeGrid(){return this._sizeGrid}set sizeGrid(t){this._sizeGrid=t?t.map((t=>+t)):null,this._setChanged()}get width(){return null!=this._width?this._width:this._source?this._source.sourceWidth:0}set width(t){this._width!=t&&(this._width=t,this._setChanged())}get height(){return null!=this._height?this._height:this._source?this._source.sourceHeight/(this._source._stateNum||this._stateNum||1):0}set height(t){this._height!=t&&(this._height=t,this._setChanged())}get source(){return this._source}set source(t){this._source&&!e.LayaEnv.isPlaying&&this._source.off("reload",this,this._setChanged),t?(this._source=t,e.SerializeUtil.isDeserializing?this._setChanged():e.ILaya.timer.runCallLater(this,this.changeSource,!0),e.LayaEnv.isPlaying||t.on("reload",this,this._setChanged)):(this._source=null,this._drawCmd=this.replaceCmd(this._drawCmd,null,!0))}get color(){return this._color}set color(t){this._color!=t&&(this._color=t,this._setChanged())}_setChanged(){this._isChanged||(this._isChanged=!0,e.ILaya.timer.callLater(this,this.changeSource))}changeSource(){this._isChanged=!1;let t=this._source;if(!t||!t.bitmap||!this._sp)return;let s=this.width,i=this.height,h=this._sizeGrid||t._sizeGrid,l=this._stateIndex;if(null!=l){let e=t._stateNum||this._stateNum||1;1==e?l=0:2==e?l=2==l?1:0:3==e&&3==l&&(l=0);let s=t.height/e;if(t=t.getCachedClip(0,s*l,t.width,s),!t)return}let r,a=t.sourceWidth,n=t.sourceHeight;r=!h||a===s&&n===i?e.DrawTextureCmd.create(t,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,s,i,null,1,this._color,null,this.uv):e.Draw9GridTextureCmd.create(t,0,0,s,i,h,!1,this._color),this._drawCmd=this.replaceCmd(this._drawCmd,r,!0)}destroy(){super.destroy(),this._source&&!e.LayaEnv.isPlaying&&this._source.off("reload",this,this._setChanged),this._source=null,this._sizeGrid=null,this._offset=null}setState(t,e){this._stateIndex=t,this._stateNum=e,this._setChanged()}}var h,l;t.UIEvent=void 0,(h=t.UIEvent||(t.UIEvent={})).SHOW_TIP="showtip",h.HIDE_TIP="hidetip";class r{static fillArray(t,e,s=null){let i=t.concat();if(e){let t=e.split(",");for(let e=0,h=Math.min(i.length,t.length);e<h;e++){let h=t[e];i[e]="true"==h||"false"!=h&&h,null!=s&&(i[e]=s(h))}}return i}static gray(t,e=!0){let s=t.filters||[],i=s.indexOf(r.grayFilter);e?-1==i&&(s.push(r.grayFilter),t.filters=s):-1!=i&&(s.splice(i,1),t.filters=s)}static getBindFun(t){r._funMap||(r._funMap=new e.WeakObject);var s=r._funMap.get(t);if(null==s){var i='"'+t+'"',h="(function(data){if(data==null)return;with(data){try{\nreturn "+(i=i.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";s=window.Laya._runScript(h),r._funMap.set(t,s)}return s}}r.grayFilter=new e.ColorFilter([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0]),r._funMap=null;class a extends e.Sprite{get top(){return this.get_top()}set top(t){this.set_top(t)}get bottom(){return this.get_bottom()}set bottom(t){this.set_bottom(t)}get left(){return this._widget.left}set left(t){t!=this._widget.left&&(this._getWidget().left=t)}get right(){return this._widget.right}set right(t){t!=this._widget.right&&(this._getWidget().right=t)}get centerX(){return this._widget.centerX}set centerX(t){t!=this._widget.centerX&&(this._getWidget().centerX=t)}get centerY(){return this._widget.centerY}set centerY(t){t!=this._widget.centerY&&(this._getWidget().centerY=t)}get dataSource(){return this.get_dataSource()}set dataSource(t){this.set_dataSource(t)}get toolTip(){return this._toolTip}set toolTip(t){this._toolTip!=t&&(this._toolTip=t,null!=t?(this.on(e.Event.MOUSE_OVER,this,this.onMouseOver),this.on(e.Event.MOUSE_OUT,this,this.onMouseOut)):(this.off(e.Event.MOUSE_OVER,this,this.onMouseOver),this.off(e.Event.MOUSE_OUT,this,this.onMouseOut)))}get gray(){return this._gray}set gray(t){t!==this._gray&&(this._gray=t,r.gray(this,t))}get disabled(){return this._disabled}set disabled(t){t!==this._disabled&&(this._disabled=t,e.SerializeUtil.isDeserializing||(this.gray=t),this.mouseEnabled=!t)}constructor(t=!0){super(),this._widget=e.Widget.EMPTY,t&&(this.preinitialize(),this.createChildren(),this.initialize())}_transChanged(t){super._transChanged(t),0!=(t&e.TransformKind.Layout)&&this.callLater(this._sizeChanged)}_sizeChanged(){this.event(e.Event.RESIZE),this._widget!==e.Widget.EMPTY&&this._widget.resetLayout()}_childChanged(t){this.callLater(this._sizeChanged),super._childChanged(t)}_getWidget(){return this._widget===e.Widget.EMPTY&&(this._widget=this.addComponent(e.Widget)),this._widget}preinitialize(){}createChildren(){}initialize(){}measureWidth(){var t=0;this.commitMeasure();for(var e=this.numChildren-1;e>-1;e--){var s=this.getChildAt(e);s._visible&&(t=Math.max(s._x+s.width*s.scaleX,t))}return t}commitMeasure(){}measureHeight(){let t=0;this.commitMeasure();for(let e=this.numChildren-1;e>-1;e--){let s=this.getChildAt(e);s._visible&&(t=Math.max(s._y+s.height*s.scaleY,t))}return t}onMouseOver(s){e.ILaya.stage.event(t.UIEvent.SHOW_TIP,this._toolTip)}onMouseOut(s){e.ILaya.stage.event(t.UIEvent.HIDE_TIP,this._toolTip)}get_top(){return this._widget.top}set_top(t){t!=this._widget.top&&(this._getWidget().top=t)}get_bottom(){return this._widget.bottom}set_bottom(t){t!=this._widget.bottom&&(this._getWidget().bottom=t)}get_dataSource(){return this._dataSource}set_dataSource(t){for(var e in this._dataSource=t,this._dataSource)e in this&&"function"!=typeof this[e]&&(this[e]=this._dataSource[e])}freshLayout(){this._widget!=e.Widget.EMPTY&&this._widget.resetLayout()}destroy(t=!0){super.destroy(t),this._dataSource=null,this._toolTip=null}}class n extends a{set_dataSource(t){this._dataSource=t;for(let e in t){let s=this.getChild(e);s?s.dataSource=t[e]:!(e in this)||this[e]instanceof Function||(this[e]=t[e])}}get bgColor(){return this._bgColor}set bgColor(t){this._bgColor=t,this.graphics.clear(),this.graphics.drawRect(0,0,1,1,this._bgColor,null,null,!0)}}class o{}o.defaultSizeGrid=[4,4,4,4,0],o.labelColor="#000000",o.labelPadding=[2,2,2,2],o.inputLabelPadding=[1,1,1,3],o.buttonStateNum=3,o.buttonLabelColors=["#32556b","#32cc6b","#ff0000"],o.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"],o.scrollBarMinNum=15,o.scrollBarDelayTime=500,t.ScrollType=void 0,(l=t.ScrollType||(t.ScrollType={}))[l.None=0]="None",l[l.Horizontal=1]="Horizontal",l[l.Vertical=2]="Vertical",l[l.Both=3]="Both";class _ extends a{get state(){return this._state}set state(t){this._state!=t&&(this._state=t,this._setStateChanged())}get skin(){return this._skin}set skin(t){this._skin!=t&&this._setSkin(t)}get stateNum(){return this._stateNum}set stateNum(t){"string"==typeof t&&(t=parseInt(t)),this._stateNum!=t&&(this._stateNum=t<1?1:t>3?3:t,this._graphics.setState(this._state,this._stateNum),this._skin&&(this.callLater(this.changeClips),this._setStateChanged()))}get label(){return this._text?this._text.text:null}set label(t){(this._text||t)&&(this.createText(),this._text.text!=t&&(t&&!this._text.parent&&this.addChild(this._text),this._text.text=(t+"").replace(/\\n/g,"\n"),this._setStateChanged()))}get selected(){return this._selected}set selected(t){this._selected!=t&&(this._selected=t,this.state=this._selected?2:0,this.event(e.Event.CHANGE))}get labelColors(){return this._labelColors.join(",")}set labelColors(t){this._labelColors=r.fillArray(o.buttonLabelColors,t,String),this._setStateChanged()}get strokeColors(){return this._strokeColors?this._strokeColors.join(","):""}set strokeColors(t){this._strokeColors=t?r.fillArray(o.buttonLabelColors,t,String):null,this._setStateChanged()}get labelPadding(){return this.createText(),this._text.padding.join(",")}set labelPadding(t){this.createText(),this._text.padding=r.fillArray(o.labelPadding,t,Number)}get labelSize(){return this.createText(),this._text.fontSize}set labelSize(t){this.createText(),this._text.fontSize=t}get labelStroke(){return this.createText(),this._text.stroke}set labelStroke(t){this.createText(),this._text.stroke=t}get labelStrokeColor(){return this.createText(),this._text.strokeColor}set labelStrokeColor(t){this.createText(),this._text.strokeColor=t}get labelBold(){return this.createText(),this._text.bold}set labelBold(t){this.createText(),this._text.bold=t}get labelFont(){return this.createText(),this._text.font}set labelFont(t){this.createText(),this._text.font=t}get labelAlign(){return this.createText(),this._text.align}set labelAlign(t){this.createText(),this._text.align=t}get labelVAlign(){return this.createText(),this._text.valign}set labelVAlign(t){this.createText(),this._text.valign=t}get clickHandler(){return this._clickHandler}set clickHandler(t){this._clickHandler=t}get text(){return this.createText(),this._text}set text(t){"string"==typeof t&&this._text&&(this._text.text=t)}get sizeGrid(){return this._graphics.sizeGrid?this._graphics.sizeGrid.join(","):null}set sizeGrid(t){this._graphics.sizeGrid=t?r.fillArray(o.defaultSizeGrid,t,Number):null}get iconOffset(){return this._graphics._offset?this._graphics._offset.join(","):null}set iconOffset(t){this._graphics._offset=t?r.fillArray([1,1],t,Number):[]}constructor(t=null,e=""){super(),this._state=0,this._autoSize=!0,this._stateChanged=!1,this._labelColors=o.buttonLabelColors,this._stateNum=o.buttonStateNum,t&&(this.skin=t),this.label=e}measureWidth(){return this._skin&&this.runCallLater(this.changeClips),this._autoSize?this._graphics.width:(this.runCallLater(this.changeState),this._graphics.width+(this._text?this._text.width:0))}measureHeight(){return this._skin&&this.runCallLater(this.changeClips),this._text?Math.max(this._graphics.height,this._text.height):this._graphics.height}destroy(t=!0){super.destroy(t),this._text&&this._text.destroy(t),this._text=null,this._clickHandler=null,this._labelColors=this._strokeColors=null}createChildren(){this.setGraphics(new i,!0)}createText(){this._text||(this._text=new e.Text,this._text.overflow=e.Text.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height,this._text.hideFlags=e.HideFlags.HideAndDontSave)}initialize(){this.on(e.Event.MOUSE_OVER,this,this.onMouse),this.on(e.Event.MOUSE_OUT,this,this.onMouse),this.on(e.Event.MOUSE_DOWN,this,this.onMouse),this.on(e.Event.MOUSE_UP,this,this.onMouse),this.on(e.Event.CLICK,this,this.onMouse)}onMouse(t){if(!1===this.toggle&&this._selected)return;let s=t?t.type:e.Event.CLICK;if(s===e.Event.CLICK)return this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run());!this._selected&&(this.state=c[s])}_setSkin(t){if(this._skin=t,t){this._skinBaseUrl&&(t=e.URL.formatURL(t,this._skinBaseUrl));let s=e.Loader.getRes(t);if(s)return this._skinLoaded(s),Promise.resolve();{const s=this._skin;return e.ILaya.loader.load(t,e.Loader.IMAGE).then((t=>{s!=this._skin||this.destroyed||this._skinLoaded(t)}))}}return this._skinLoaded(null),Promise.resolve()}_skinLoaded(t){this._destroyed||(this._graphics.source=t,t&&this.callLater(this.changeClips),this._setStateChanged(),this._sizeChanged(),this.event(e.Event.LOADED))}_transChanged(t){super._transChanged(t),this._autoSize&&(0!=(t&e.TransformKind.Width)&&(this._graphics.width=this._width,this._text&&(this._text.width=this._width)),0!=(t&e.TransformKind.Height)&&(this._graphics.height=this._height,this._text&&(this._text.height=this._height)))}changeClips(){let t=0,s=0,i=e.Loader.getRes(this._skin);i?(t=i.sourceWidth,s=i.sourceHeight/(i._stateNum||this._stateNum),this._autoSize?(this._graphics.width=this._isWidthSet?this._width:t,this._graphics.height=this._isHeightSet?this._height:s,this._text&&(this._text.width=this._graphics.width,this._text.height=this._graphics.height)):this._text&&(this._text.x=t,this._text.height=s)):console.log(`lose skin ${this._skin}`)}changeState(){this._stateChanged=!1,this._skin&&this.runCallLater(this.changeClips);let t=Math.max(this._state,0);this._graphics.setState(t,this._stateNum),this.label&&(this._text.color=this._labelColors[t],this._strokeColors&&(this._text.strokeColor=this._strokeColors[t]))}_setStateChanged(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))}set_dataSource(t){"number"==typeof t||"string"==typeof t?(this._dataSource=t,this.label=t+""):super.set_dataSource(t)}}const c={mouseup:0,mouseover:1,mousedown:2,mouseout:0};class d extends _{constructor(t=null,e=""){super(t,e),this.toggle=!0,this._autoSize=!1}preinitialize(){super.preinitialize(),this.toggle=!0,this._autoSize=!1}initialize(){super.initialize(),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=null}set_dataSource(t){this._dataSource=t,t instanceof Boolean?this.selected=t:"string"==typeof t?this.selected="true"===t:super.set_dataSource(t)}}class u extends a{get skin(){return this._skin}set skin(t){this._skin!=t&&this._setSkin(t)}get clipX(){return this._clipX}set clipX(t){this._clipX=t||1,this._setClipChanged()}get clipY(){return this._clipY}set clipY(t){this._clipY=t||1,this._setClipChanged()}get clipWidth(){return this._clipWidth}set clipWidth(t){this._clipWidth=t,this._setClipChanged()}get clipHeight(){return this._clipHeight}set clipHeight(t){this._clipHeight=t,this._setClipChanged()}get sources(){return this._sources}set sources(t){this._sources=t,this.index=this._index,this.event(e.Event.LOADED)}get group(){return this._group}set group(t){t&&this._skin&&e.Loader.setGroup(this._skin,t),this._group=t}get sizeGrid(){return this._graphics.sizeGrid?this._graphics.sizeGrid.join(","):null}set sizeGrid(t){this._graphics.sizeGrid=t?r.fillArray(o.defaultSizeGrid,t,Number):null}get index(){return this._index}set index(t){this._index=t,this._graphics&&(this._graphics.source=this._sources[t]),this.event(e.Event.CHANGE)}get total(){return this.runCallLater(this.changeClip),this._sources.length}get autoPlay(){return this._autoPlay}set autoPlay(t){this._autoPlay!=t&&(this._autoPlay=t,t?this.play():this.stop())}get interval(){return this._interval}set interval(t){this._interval!=t&&(this._interval=t,this._isPlaying&&this.play())}get isPlaying(){return this._isPlaying}set isPlaying(t){this._isPlaying=t}constructor(t=null,e=1,s=1){super(),this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._interval=50,this._index=0,this._toIndex=-1,this._sources=[],this._clipX=e,this._clipY=s,this.skin=t}_onDisplay(){this._isPlaying?this.displayedInStage?this.play():this.stop():this._autoPlay&&this.play()}_setSkin(t){return this._skin=t,t?(this._skinBaseUrl&&(t=e.URL.formatURL(t,this._skinBaseUrl)),e.Loader.getRes(t)?(this._skinLoaded(),Promise.resolve()):e.ILaya.loader.load(t,e.Loader.IMAGE).then((()=>this._skinLoaded()))):(this._graphics.source=null,Promise.resolve())}_skinLoaded(){this._destroyed||(this._setClipChanged(),this._sizeChanged(),this.event(e.Event.LOADED))}_setClipChanged(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))}_transChanged(t){super._transChanged(t),0!=(t&e.TransformKind.Width)&&(this._graphics.width=this._width),0!=(t&e.TransformKind.Height)&&(this._graphics.height=this._height)}_loop(){this._visible&&(this._index++,this._toIndex>-1&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)}createChildren(){this.setGraphics(new i,!0)}changeClip(){if(this._clipChanged=!1,!this._skin||this._destroyed)return;let t=this._skinBaseUrl?e.URL.formatURL(this._skin,this._skinBaseUrl):this._skin,s=e.Loader.getRes(t);s?this.loadComplete(this._skin,s):e.ILaya.loader.load(t,e.Handler.create(this,this.loadComplete,[this._skin]),null,e.Loader.IMAGE)}loadComplete(t,s){if(t===this._skin){if(this._sources.length=0,s){var i=this._clipWidth||Math.ceil(s.sourceWidth/this._clipX),h=this._clipHeight||Math.ceil(s.sourceHeight/this._clipY);for(let t=0;t<this._clipY;t++)for(let e=0;e<this._clipX;e++)this._sources.push(s.getCachedClip(i*e,h*t,i,h))}this.index=this._index,this.event(e.Event.LOADED),this._sizeChanged()}}measureWidth(){return this.runCallLater(this.changeClip),this._graphics.width}measureHeight(){return this.runCallLater(this.changeClip),this._graphics.height}play(t=0,s=-1){this._setClipChanged(),this._isPlaying=!0,this.index=t,this._toIndex=s,e.ILaya.timer.loop(this.interval,this,this._loop),this.on(e.Event.DISPLAY,this,this._onDisplay),this.on(e.Event.UNDISPLAY,this,this._onDisplay)}stop(){this._isPlaying=!1,e.ILaya.timer.clear(this,this._loop),this.event(e.Event.COMPLETE)}set_dataSource(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.index=parseInt(t):super.set_dataSource(t)}}class g extends a{get selectedColor(){return this._selectedColor}set selectedColor(t){this._selectedColor!=t&&(this._selectedColor=this._colorInput.text=t,this.drawBlock(t),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event(e.Event.CHANGE,e.Event.EMPTY))}get skin(){return this._colorButton.skin}set skin(t){this._colorButton.once(e.Event.LOADED,this,this.changeColor),this._colorButton.skin=t}get bgColor(){return this._bgColor}set bgColor(t){this._bgColor=t,this._setPanelChanged()}get borderColor(){return this._borderColor}set borderColor(t){this._borderColor=t,this._setPanelChanged()}get inputColor(){return this._inputColor}set inputColor(t){this._inputColor=t,this._setPanelChanged()}get inputBgColor(){return this._inputBgColor}set inputBgColor(t){this._inputBgColor=t,this._setPanelChanged()}constructor(t=!0){super(!1),this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colors=[],this._selectedColor="#000000",t&&(this.preinitialize(),this.createChildren(),this.initialize())}_setPanelChanged(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))}createChildren(){this._colorButton=new _,this._colorButton.hideFlags=e.HideFlags.HideAndDontSave,this.addChild(this._colorButton),this._colorPanel=new n,this._colorPanel.hideFlags=e.HideFlags.HideAndDontSave,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new e.Sprite),this._colorPanel.addChild(this._colorBlock=new e.Sprite),this._colorPanel.addChild(this._colorInput=new e.Input)}initialize(){this._colorButton.on(e.Event.CLICK,this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on(e.Event.CHANGE,this,this.onColorInputChange),this._colorInput.on(e.Event.KEY_DOWN,this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on(e.Event.MOUSE_MOVE,this,this.onColorTilesMouseMove),this._colorTiles.on(e.Event.CLICK,this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on(e.Event.MOUSE_DOWN,this,this.onPanelMouseDown),this.bgColor=this._bgColor}onPanelMouseDown(t){t.stopPropagation()}changePanel(){this._panelChanged=!1;var t=this._colorPanel.graphics;t.clear(!0),t.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(t=this._colorTiles.graphics).clear(!0);for(var s=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],i=0;i<12;i++)for(var h=0;h<20;h++){var l;l=0===h?s[i]:1===h?0:51*(((3*i+h/6)%3<<0)+3*(i/6<<0))<<16|h%6*51<<8|(i<<0)%6*51;var r=e.Color.hexToString(l);this._colors.push(r);var a=h*this._gridSize,n=i*this._gridSize;t.drawRect(a,n,this._gridSize,this._gridSize,r,"#000000")}}onColorButtonClick(t){this._colorPanel.parent?this.close():this.open()}removeColorBox(t=null){this.close()}onColorFieldKeyDown(t){13==t.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),t.stopPropagation())}onColorInputChange(t=null){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")}onColorTilesClick(t){this.selectedColor=this.getColorByMouse(),this.close()}onColorTilesMouseMove(t){this._colorInput.focus=!1;var e=this.getColorByMouse();this._colorInput.text=e,this.drawBlock(e)}getColorByMouse(){var t=this._colorTiles.getMousePoint(),e=Math.floor(t.x/this._gridSize),s=Math.floor(t.y/this._gridSize);return this._colors[20*s+e]}drawBlock(t){var e=this._colorBlock.graphics;e.clear(!0);var s=t||"#ffffff";e.drawRect(0,0,50,20,s,this._borderColor),t||e.drawLine(0,0,50,20,"#ff0000")}changeColor(){var t=this.graphics;t.clear(!0);var e=this._selectedColor||"#000000";t.drawRect(0,0,this._colorButton.width,this._colorButton.height,e)}open(){let t=e.ILaya.stage;var s=this.localToGlobal(new e.Point),i=s.x+this._colorPanel.width<=t.width?s.x:t.width-this._colorPanel.width,h=s.y+this._colorButton.height;h=h+this._colorPanel.height<=t.height?h:s.y-this._colorPanel.height,this._colorPanel.pos(i,h),this._colorPanel.zOrder=1001,t.addChild(this._colorPanel),t.on(e.Event.MOUSE_DOWN,this,this.removeColorBox)}close(){e.ILaya.stage.off(e.Event.MOUSE_DOWN,this,this.removeColorBox),this._colorPanel.removeSelf()}destroy(t=!0){e.ILaya.stage.off(e.Event.MOUSE_DOWN,this,this.removeColorBox),super.destroy(t),this._colorPanel&&this._colorPanel.destroy(t),this._colorButton&&this._colorButton.destroy(t),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null}}class p extends a{get text(){return this._tf.text}set text(t){this._tf.text=t}get wordWrap(){return this._tf.wordWrap}set wordWrap(t){this._tf.wordWrap=t}get color(){return this._tf.color}set color(t){this._tf.color=t}get font(){return this._tf.font}set font(t){this._tf.font=t}get align(){return this._tf.align}set align(t){this._tf.align=t}get valign(){return this._tf.valign}set valign(t){this._tf.valign=t}get alignItems(){return this._tf.alignItems}set alignItems(t){this._tf.alignItems=t}get bold(){return this._tf.bold}set bold(t){this._tf.bold=t}get italic(){return this._tf.italic}set italic(t){this._tf.italic=t}get leading(){return this._tf.leading}set leading(t){this._tf.leading=t}get fontSize(){return this._tf.fontSize}set fontSize(t){this._tf.fontSize=t}get padding(){return this._tf.padding.join(",")}set padding(t){this._tf.padding=r.fillArray(o.labelPadding,t,Number)}get bgColor(){return this._tf.bgColor}set bgColor(t){this._tf.bgColor=t}get borderColor(){return this._tf.borderColor}set borderColor(t){this._tf.borderColor=t}get stroke(){return this._tf.stroke}set stroke(t){this._tf.stroke=t}get strokeColor(){return this._tf.strokeColor}set strokeColor(t){this._tf.strokeColor=t}get html(){return this._tf.html}set html(t){this._tf.html=t}get ubb(){return this._tf.ubb}set ubb(t){this._tf.ubb=t}get maxWidth(){return this._tf.maxWidth}set maxWidth(t){this._tf.maxWidth=t}get fitContent(){return this._fitContent}set fitContent(t){"boolean"==typeof t&&(t=t?"yes":"no"),this._fitContent!=t&&("yes"!=t&&"height"!=t||e.SerializeUtil.isDeserializing||!(e.LayaEnv.isPlaying||this._tf.textWidth>0&&this._tf.textHeight>0)||("height"==t?this.height=this._tf.textHeight:this.size(this._tf.textWidth,this._tf.textHeight)),this._fitContent=t)}get textField(){return this._tf}get overflow(){return this._tf.overflow}set overflow(t){this._tf.overflow=t}get underline(){return this._tf.underline}set underline(t){this._tf.underline=t}get underlineColor(){return this._tf.underlineColor}set underlineColor(t){this._tf.underlineColor=t}get strikethrough(){return this._tf.strikethrough}set strikethrough(t){this._tf.strikethrough=t}get strikethroughColor(){return this._tf.strikethroughColor}set strikethroughColor(t){this._tf.strikethroughColor=t}get ignoreLang(){return this._tf.ignoreLang}set ignoreLang(t){this._tf.ignoreLang=t}get templateVars(){return this._tf.templateVars}set templateVars(t){this._tf.templateVars=t}setVar(t,e){return this._tf.setVar(t,e),this}constructor(t){super(),this._fitContent="no",null!=t&&(this.text=t)}_onPostLayout(){"yes"!=this._fitContent&&"height"!=this._fitContent||!(e.LayaEnv.isPlaying||this._tf.textWidth>0&&this._tf.textHeight>0)||(this._fitFlag=!0,"height"==this._fitContent?this.height=this._tf.textHeight:this.size(this._tf.textWidth,this._tf.textHeight),this._fitFlag=!1)}_transChanged(t){super._transChanged(t),0!=(t&e.TransformKind.Width)&&(this._tf.width=this._width),0!=(t&e.TransformKind.Height)&&(this._tf.height=this._height)}createChildren(){this._tf=new e.Text,this._tf.hideFlags=e.HideFlags.HideAndDontSave,this._tf._parseEscapeChars=!0,this._tf._onPostLayout=()=>this._onPostLayout(),this._tf.on(e.Event.CHANGE,(()=>{this.event(e.Event.CHANGE),this._isWidthSet&&this._isHeightSet||this._sizeChanged()})),this.addChild(this._tf)}measureWidth(){return this._tf.width}measureHeight(){return this._tf.height}size(t,e){return"yes"!=this._fitContent||this._fitFlag||(t=this._width),"yes"!=this._fitContent&&"height"!=this._fitContent||this._fitFlag||(e=this._height),super.size(t,e)}set_dataSource(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.text=t+"":super.set_dataSource(t)}}class S extends a{get skin(){return this._skin}set skin(t){""==t&&(t=null),this._skin!=t&&this._setSkin(t)}get sizeGrid(){return this._graphics.sizeGrid?this._graphics.sizeGrid.join(","):null}set sizeGrid(t){this._graphics.sizeGrid=t?r.fillArray(o.defaultSizeGrid,t,Number):null}get source(){return this._graphics.source}set source(t){this._graphics&&(this._graphics.source=t,this.event(e.Event.LOADED),this.repaint(),this._useSourceSize&&t?(this.size(t.sourceWidth,t.sourceHeight),this._useSourceSize=!0):this._sizeChanged())}get color(){return this._graphics.color}set color(t){this._graphics.color=t}get group(){return this._group}set group(t){t&&this._skin&&e.Loader.setGroup(this._skin,t),this._group=t}get useSourceSize(){return this._useSourceSize}set useSourceSize(t){this._useSourceSize!=t&&(t&&this._graphics.source&&this.size(this._graphics.source.sourceWidth,this._graphics.source.sourceHeight),this._useSourceSize=t)}constructor(t=null){super(),this.skin=t}_setSkin(t){if(this._skin=t,t){this._skinBaseUrl&&(t=e.URL.formatURL(t,this._skinBaseUrl));let s=e.Loader.getRes(t);if(s)return this.source=s,Promise.resolve();{let s=this._skin;return e.ILaya.loader.load(t,{type:e.Loader.IMAGE,group:this._group}).then((t=>{s!=this._skin||this.destroyed||(this.source=t)}))}}return this.source=null,Promise.resolve()}_transChanged(t){super._transChanged(t),0!=(t&e.TransformKind.Width)&&(this._graphics.width=this._width),0!=(t&e.TransformKind.Height)&&(this._graphics.height=this._height),0!=(t&e.TransformKind.Size)&&(e.SerializeUtil.isDeserializing||(this._useSourceSize=!1))}measureWidth(){return this._graphics.width}measureHeight(){return this._graphics.height}createChildren(){this.setGraphics(new i,!0)}set_dataSource(t){this._dataSource=t,"string"==typeof t?this.skin=t:super.set_dataSource(t)}dispose(){this.destroy(!0),e.ILaya.loader.clearRes(this._skin)}}class f extends a{constructor(t=null){super(),this.isVertical=!0,this.showLabel=!0,this._showProgress=!1,this._max=100,this._min=0,this._tick=1,this._value=0,f.label||(f.label=new p,f.label.hideFlags=e.HideFlags.HideAndDontSave),this.skin=t}destroy(t=!0){super.destroy(t),this._bg&&this._bg.destroy(t),this._bar&&this._bar.destroy(t),this._progress&&this._progress.destroy(t),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null}createChildren(){this._bg=new S,this._bg.hideFlags=e.HideFlags.HideAndDontSave,this.addChild(this._bg),this._progress=new S,this._progress.hideFlags=e.HideFlags.HideAndDontSave,this.addChildAt(this._progress,1),this._bar=new _,this._bar.hideFlags=e.HideFlags.HideAndDontSave,this.addChild(this._bar)}initialize(){this._bar.on(e.Event.MOUSE_DOWN,this,this.onBarMouseDown),this.allowClickBack=!0}onBarMouseDown(t){let s=e.ILaya.stage;this._globalSacle||(this._globalSacle=new e.Point),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=s.mouseX,this._ty=s.mouseY,s.on(e.Event.MOUSE_MOVE,this,this.mouseMove),s.once(e.Event.MOUSE_UP,this,this.mouseUp),s.once(e.Event.MOUSE_OUT,this,this.mouseUp),this.showValueText()}showValueText(){if(this.showLabel){var t=f.label;this.addChild(t),t.textField.text=this._value+"",this.isVertical?(t.x=this._bar._x+20,t.y=.5*(this._bar.height-t.height)+this._bar._y):(t.y=this._bar._y-20,t.x=.5*(this._bar.width-t.width)+this._bar._x)}}hideValueText(){f.label&&f.label.removeSelf()}mouseUp(t){let s=e.ILaya.stage;s.off(e.Event.MOUSE_MOVE,this,this.mouseMove),s.off(e.Event.MOUSE_UP,this,this.mouseUp),s.off(e.Event.MOUSE_OUT,this,this.mouseUp),this.sendChangeEvent(e.Event.CHANGED),this.hideValueText()}mouseMove(t){let s=e.ILaya.stage;var i=this._value;if(this.isVertical?(this._bar.y+=(s.mouseY-this._ty)/this._globalSacle.y,this._bar._y>this._maxMove?this._bar.y=this._maxMove:this._bar._y<0&&(this._bar.y=0),this._value=this._bar._y/this._maxMove*(this._max-this._min)+this._min,this._progress.height=this._bar._y+.5*this._bar.height):(this._bar.x+=(s.mouseX-this._tx)/this._globalSacle.x,this._bar._x>this._maxMove?this._bar.x=this._maxMove:this._bar._x<0&&(this._bar.x=0),this._value=this._bar._x/this._maxMove*(this._max-this._min)+this._min,this._progress.width=this._bar._x+.5*this._bar.width),this._tx=s.mouseX,this._ty=s.mouseY,0!=this._tick){var h=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*h)/h}this._value!=i&&this.sendChangeEvent(),this.showValueText()}sendChangeEvent(t=e.Event.CHANGE){this.event(t),this.changeHandler&&this.changeHandler.runWith(this._value)}get skin(){return this._skin}set skin(t){""==t&&(t=null),this._skin!=t&&this._setSkin(t)}get showProgress(){return this._showProgress}set showProgress(t){this._showProgress=t,t?this._skin&&!e.SerializeUtil.isDeserializing&&this._setSkin(this._skin):this._progress.skin=null}_setSkin(t){return this._skin=t,t?e.AssetDb.inst.resolveURL(t).then((t=>{if(this._destroyed)return null;this._skinBaseUrl&&(t=e.URL.formatURL(t,this._skinBaseUrl));let s=[this._bg._setSkin(t),this._bar._setSkin(e.Utils.replaceFileExtension(t,"$bar.png",!0))];return this._showProgress?s.push(this._progress._setSkin(e.Utils.replaceFileExtension(t,"$progress.png",!0))):this._progress.skin=null,Promise.all(s).then((()=>this._skinLoaded()))})):(this._bg.skin=null,this._bar.skin=null,this._progress.skin=null,this._skinLoaded(),Promise.resolve())}_skinLoaded(){this._destroyed||(this.setBarPoint(),this.callLater(this.changeValue),this._sizeChanged(),this.event(e.Event.LOADED))}setBarPoint(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))}measureWidth(){return Math.max(this._bg.width,this._bar.width)}measureHeight(){return Math.max(this._bg.height,this._bar.height)}_sizeChanged(){super._sizeChanged(),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()}get sizeGrid(){return this._bg.sizeGrid}set sizeGrid(t){this._bg.sizeGrid=t,this._bar.sizeGrid=t,this._progress.sizeGrid=this._bar.sizeGrid}setSlider(t,e,s){let i;null==s&&(t>=e?s=this.value:i=this._max==this._min?0:this._value/(this._max-this._min)),this._value=-1,this._min=t,this._max=e>t?e:t,this.value=null==i?s<t?t:s>e?e:s:(this._max-this._min)*i}get tick(){return this._tick}set tick(t){this._tick!=t&&(this._tick=t,this.callLater(this.changeValue))}changeValue(){if(0!=this.tick){var t=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*t)/t}this._max>=this._min?this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value:this._value=this._value>this._min?this._min:this._value<this._max?this._max:this._value;var e=this._max-this._min;0===e&&(e=1),this.isVertical?(this._bar.y=(this._value-this._min)/e*(this.height-this._bar.height),this._progress.height=this._bar._y+.5*this._bar.height):(this._bar.x=(this._value-this._min)/e*(this.width-this._bar.width),this._progress.width=this._bar._x+.5*this._bar.width)}get max(){return this._max}set max(t){this._max!=t&&(this._max=t,this.callLater(this.changeValue))}get min(){return this._min}set min(t){this._min!=t&&(this._min=t,this.callLater(this.changeValue))}get value(){return this._value}set value(t){if(this._value!=t){var e=this._value;this._value=t,this.changeValue(),this._value!=e&&this.sendChangeEvent()}}get allowClickBack(){return this._allowClickBack}set allowClickBack(t){this._allowClickBack!=t&&(this._allowClickBack=t,t?this._bg.on(e.Event.MOUSE_DOWN,this,this.onBgMouseDown):this._bg.off(e.Event.MOUSE_DOWN,this,this.onBgMouseDown))}onBgMouseDown(t){var e=this._bg.getMousePoint();this.isVertical?this.value=e.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=e.x/(this.width-this._bar.width)*(this._max-this._min)+this._min}set_dataSource(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.value=Number(t):super.set_dataSource(t)}get bar(){return this._bar}}f.label=null;class m extends a{constructor(t=null){super(),this.rollRatio=.97,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.topMoveLimit=0,this.bottomMoveLimit=0,this.disableDrag=!1,this._scrollSize=1,this._thumbPercent=1,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._hide=!1,this._clickOnly=!0,this._showButtons=s.showButtons,this._touchScrollEnable=s.touchScrollEnable,this._mouseWheelEnable=s.mouseWheelEnable,this.skin=t,this.max=1}destroy(t=!0){this.stopScroll(),this.target=null,super.destroy(t),this.upButton&&this.upButton.destroy(t),this.downButton&&this.downButton.destroy(t),this.slider&&this.slider.destroy(t),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null}createChildren(){this.slider=new f,this.slider.hideFlags=e.HideFlags.HideAndDontSave,this.addChild(this.slider),this.upButton=new _,this.upButton.hideFlags=e.HideFlags.HideAndDontSave,this.addChild(this.upButton),this.downButton=new _,this.downButton.hideFlags=e.HideFlags.HideAndDontSave,this.addChild(this.downButton)}initialize(){this.slider.showLabel=!1,this.slider.tick=0,this.slider.on(e.Event.CHANGE,this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on(e.Event.MOUSE_DOWN,this,this.onButtonMouseDown),this.downButton.on(e.Event.MOUSE_DOWN,this,this.onButtonMouseDown)}onSliderChange(){this._value!=this.slider.value&&(this.value=this.slider.value)}onButtonMouseDown(t){var s=t.currentTarget===this.upButton;this.slide(s),e.ILaya.timer.once(o.scrollBarDelayTime,this,this.startLoop,[s]),e.ILaya.stage.once(e.Event.MOUSE_UP,this,this.onStageMouseUp)}startLoop(t){e.ILaya.timer.frameLoop(1,this,this.slide,[t])}slide(t){t?this.value-=this._scrollSize:this.value+=this._scrollSize}onStageMouseUp(t){e.ILaya.timer.clear(this,this.startLoop),e.ILaya.timer.clear(this,this.slide)}get skin(){return this._skin}set skin(t){""==t&&(t=null),this._skin!=t&&this._setSkin(t)}_setSkin(t){return this._skin=t,t?e.AssetDb.inst.resolveURL(t).then((t=>this._destroyed?null:(this._skinBaseUrl&&(t=e.URL.formatURL(t,this._skinBaseUrl)),Promise.all([this.slider._setSkin(t),this.upButton._setSkin(e.Utils.replaceFileExtension(t,"$up.png",!0)),this.downButton._setSkin(e.Utils.replaceFileExtension(t,"$down.png",!0))]).then((()=>this._skinLoaded()))))):(this.slider.skin=null,this.upButton.skin=null,this.downButton.skin=null,this._skinLoaded(),Promise.resolve())}_skinLoaded(){this._destroyed||(this.callLater(this.changeScrollBar),this._sizeChanged(),this.event(e.Event.LOADED))}changeScrollBar(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()}_sizeChanged(){super._sizeChanged(),this.repaint(),this.resetPositions(),this.event(e.Event.CHANGE),this.changeHandler&&this.changeHandler.runWith(this.value)}resetPositions(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()}resetButtonPosition(){this.slider.isVertical?this.downButton.y=this.slider._y+this.slider.height:this.downButton.x=this.slider._x+this.slider.width}measureWidth(){return this.slider.isVertical?this.slider.width:100}measureHeight(){return this.slider.isVertical?100:this.slider.height}setScroll(t,e,s){this.runCallLater(this._sizeChanged),this.slider.setSlider(t,e,s),this.slider.bar.visible=e>0,!this._hide&&this.autoHide&&(this.visible=!1)}get max(){return this.slider.max}set max(t){this.slider.max=t}get min(){return this.slider.min}set min(t){this.slider.min=t}get value(){return this._value}set value(t){t!==this._value&&(this._value=t,this._isElastic||(this.slider._value!=t&&(this.slider._value=t,this.slider.changeValue()),this._value=this.slider._value),this.event(e.Event.CHANGE),this.changeHandler&&this.changeHandler.runWith(this._value))}get isVertical(){return this.slider.isVertical}set isVertical(t){this.slider.isVertical=t}get sizeGrid(){return this.slider.sizeGrid}set sizeGrid(t){this.slider.sizeGrid=t}get scrollSize(){return this._scrollSize}set scrollSize(t){this._scrollSize=t}set_dataSource(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.value=Number(t):super.set_dataSource(t)}get thumbPercent(){return this._thumbPercent}set thumbPercent(t){this.runCallLater(this.changeScrollBar),this.runCallLater(this._sizeChanged),t=t>=1?.99:t,this._thumbPercent=t,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*t,o.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*t,o.scrollBarMinNum))}get target(){return this._target}set target(t){this._target&&(this._target.off(e.Event.MOUSE_WHEEL,this,this.onTargetMouseWheel),this._target.off(e.Event.MOUSE_DOWN,this,this.onTargetMouseDown)),this._target=t,t&&(this._mouseWheelEnable&&this._target.on(e.Event.MOUSE_WHEEL,this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on(e.Event.MOUSE_DOWN,this,this.onTargetMouseDown))}get hide(){return this._hide}set hide(t){this._hide=t,this.visible=!t}get showButtons(){return this._showButtons}set showButtons(t){this._showButtons=t,this.callLater(this.changeScrollBar)}get touchScrollEnable(){return this._touchScrollEnable}set touchScrollEnable(t){this._touchScrollEnable=t,this.target=this._target}get mouseWheelEnable(){return this._mouseWheelEnable}set mouseWheelEnable(t){this._mouseWheelEnable=t,this.target=this._target}onTargetMouseWheel(t){this.value+=t.delta*this._scrollSize,this.target=this._target}onTargetMouseDown(t){this.isLockedFun&&!this.isLockedFun(t)||(this.event(e.Event.END),this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new e.Point),this._lastPoint.setTo(e.ILaya.stage.mouseX,e.ILaya.stage.mouseY),e.ILaya.timer.clear(this,this.tweenMove),e.Tween.killAll(this),e.ILaya.stage.once(e.Event.MOUSE_UP,this,this.onStageMouseUp2),e.ILaya.stage.once(e.Event.MOUSE_OUT,this,this.onStageMouseUp2),e.ILaya.timer.frameLoop(1,this,this.loop))}startDragForce(){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new e.Point),this._lastPoint.setTo(e.ILaya.stage.mouseX,e.ILaya.stage.mouseY),e.ILaya.timer.clear(this,this.tweenMove),e.Tween.killAll(this),e.ILaya.stage.once(e.Event.MOUSE_UP,this,this.onStageMouseUp2),e.ILaya.stage.once(e.Event.MOUSE_OUT,this,this.onStageMouseUp2),e.ILaya.timer.frameLoop(1,this,this.loop)}cancelDragOp(){e.ILaya.stage.off(e.Event.MOUSE_UP,this,this.onStageMouseUp2),e.ILaya.stage.off(e.Event.MOUSE_OUT,this,this.onStageMouseUp2),e.ILaya.timer.clear(this,this.tweenMove),e.ILaya.timer.clear(this,this.loop),this._target.mouseEnabled=!0}checkTriggers(t=!1){return this.value>=0&&this.value-this._lastOffset<=0&&this.triggerDownDragLimit&&this.triggerDownDragLimit(t)?(this.cancelDragOp(),this.value=0,!0):!!(this.value<=this.max&&this.value-this._lastOffset>=this.max&&this.triggerUpDragLimit&&this.triggerUpDragLimit(t))&&(this.cancelDragOp(),this.value=this.max,!0)}get lastOffset(){return this._lastOffset}startTweenMoveForce(t){this._lastOffset=t,e.ILaya.timer.frameLoop(1,this,this.tweenMove,[200])}loop(){if(!this.disableDrag){var t=e.ILaya.stage.mouseY,s=e.ILaya.stage.mouseX;if(this._lastOffset=this.isVertical?t-this._lastPoint.y:s-this._lastPoint.x,this._clickOnly){if(!(Math.abs(this._lastOffset*(this.isVertical?e.ILaya.stage._canvasTransform.getScaleY():e.ILaya.stage._canvasTransform.getScaleX()))>1))return;if(this._clickOnly=!1,this.checkTriggers())return;this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event(e.Event.START)}else if(this.checkTriggers())return;this._offsets.push(this._lastOffset),this._lastPoint.x=s,this._lastPoint.y=t,0!==this._lastOffset&&(this._checkElastic||(this.elasticDistance>0?this._checkElastic||0==this._lastOffset||(this._lastOffset>0&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this._lastOffset>0?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):(this.value-=.5*this._lastOffset,this._value>=this.min&&(this._checkElastic=!1)):this._value>=this.max&&(this._lastOffset<0?this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance):(this.value-=.5*this._lastOffset,this._value<=this.max&&(this._checkElastic=!1))):this.value-=this._lastOffset)}}onStageMouseUp2(t){if(e.ILaya.stage.off(e.Event.MOUSE_UP,this,this.onStageMouseUp2),e.ILaya.stage.off(e.Event.MOUSE_OUT,this,this.onStageMouseUp2),e.ILaya.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic){if(this._value<this.min){this.min-this._value>=this.topMoveLimit&&this.event("dragTopLimit");var s=this.stopMoveLimit&&this.stopMoveLimit()?this.min-this.topMoveLimit:this.min;e.Tween.to(this,{value:s},this.elasticBackTime,m.easeFunction,e.Handler.create(this,this.elasticOver))}else if(this._value>this.max){this._value-this.max>=this.bottomMoveLimit&&this.event("dragBottomLimit");s=this.stopMoveLimit&&this.stopMoveLimit()?this.max+this.bottomMoveLimit:this.max;e.Tween.to(this,{value:s},this.elasticBackTime,m.easeFunction,e.Handler.create(this,this.elasticOver))}}else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?e.ILaya.stage.mouseY-this._lastPoint.y:e.ILaya.stage.mouseX-this._lastPoint.x);for(var i=0,h=Math.min(this._offsets.length,3),l=0;l<h;l++)i+=this._offsets[this._offsets.length-1-l];if(this._lastOffset=i/h,(i=Math.abs(this._lastOffset))<2)return void this.event(e.Event.END);i>250&&(this._lastOffset=this._lastOffset>0?250:-250);var r=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/150)));e.ILaya.timer.frameLoop(1,this,this.tweenMove,[r])}}elasticOver(){this._isElastic=!1,!this.hide&&this.autoHide&&e.Tween.to(this,{alpha:0},500),this.event(e.Event.END)}tweenMove(t){var s;if((this._lastOffset*=this.rollRatio,!this.checkTriggers(!0))&&(t>0&&(this._lastOffset>0&&this.value<=this.min?(this._isElastic=!0,s=.5*-(this.min-t-this.value),this._lastOffset>s&&(this._lastOffset=s)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,s=.5*-(this.max+t-this.value),this._lastOffset<s&&(this._lastOffset=s))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<.1)){if(e.ILaya.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?e.Tween.to(this,{value:this.min},this.elasticBackTime,m.easeFunction,e.Handler.create(this,this.elasticOver)):this._value>this.max?e.Tween.to(this,{value:this.max},this.elasticBackTime,m.easeFunction,e.Handler.create(this,this.elasticOver)):this.elasticOver());this.event(e.Event.END),!this.hide&&this.autoHide&&e.Tween.to(this,{alpha:0},500)}}stopScroll(){this.onStageMouseUp2(null),e.ILaya.timer.clear(this,this.tweenMove),e.Tween.killAll(this)}get tick(){return this.slider.tick}set tick(t){this.slider.tick=t}backToNormal(){this._value<this.min?this._backToNormal(this.min):this._value>this.max&&this._backToNormal(this.max)}_backToNormal(t){e.Tween.to(this,{value:t},this.elasticBackTime,m.easeFunction,e.Handler.create(this,this.elasticOver))}}m.easeFunction=e.Ease.sineOut;class C extends m{}class v extends m{initialize(){super.initialize(),this.slider.isVertical=!1}}class b extends n{constructor(){super(...arguments),this.selectEnable=!1,this.totalPage=0,this.disableStopScroll=!1,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._cells=[],this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._createdLine=0,this._offset=new e.Point,this._usedCache=null,this._elasticEnabled=!1,this._scrollType=0,this._preLen=0}get page(){return this._page}set page(t){this._page=t,this._array&&(this._page=t>0?t:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}get length(){return this._array?this._array.length:0}get cells(){return this.runCallLater(this.changeCells),this._cells}get elasticEnabled(){return this._elasticEnabled}set elasticEnabled(t){this._elasticEnabled=t,this._scrollBar&&(this._scrollBar.elasticDistance=t?200:0)}set cacheAs(t){super.cacheAs=t,this._scrollBar&&(this._usedCache=null,"none"!==t?this._scrollBar.on(e.Event.START,this,this.onScrollStart):this._scrollBar.off(e.Event.START,this,this.onScrollStart))}get cacheAs(){return super.cacheAs}get content(){return this._content}get scrollType(){return this._scrollType}set scrollType(s){if(this._scrollType=s,this._scrollType==t.ScrollType.None)this._scrollBar&&(this._scrollBar.destroy(),this._scrollBar=null,this._content.scrollRect=null);else if(this._scrollType==t.ScrollType.Horizontal){if(this._scrollBar&&!this._scrollBar.isVertical)return void(this._scrollBar.skin=this._hScrollBarSkin);this._scrollBar&&(this._scrollBar.destroy(),this._scrollBar=null);let t=new v;t.name="scrollBar",t.bottom=0,t._skinBaseUrl=this._skinBaseUrl,t.skin=this._hScrollBarSkin,t.elasticDistance=this._elasticEnabled?200:0,t.hideFlags=e.HideFlags.HideAndDontSave,this.scrollBar=t,this._setCellChanged()}else{if(this._scrollBar&&this._scrollBar.isVertical)return void(this._scrollBar.skin=this._vScrollBarSkin);this._scrollBar&&(this._scrollBar.destroy(),this._scrollBar=null);let t=new C;t.name="scrollBar",t.right=0,t._skinBaseUrl=this._skinBaseUrl,t.skin=this._vScrollBarSkin,t.elasticDistance=this._elasticEnabled?200:0,t.hideFlags=e.HideFlags.HideAndDontSave,this.scrollBar=t,this._setCellChanged()}}get vScrollBarSkin(){return this._vScrollBarSkin}set vScrollBarSkin(e){""==e&&(e=null),this._vScrollBarSkin!=e&&(this._vScrollBarSkin=e,0==this._scrollType?this.scrollType=t.ScrollType.Vertical:this.scrollType=this._scrollType)}get hScrollBarSkin(){return this._hScrollBarSkin}set hScrollBarSkin(e){""==e&&(e=null),this._hScrollBarSkin!=e&&(this._hScrollBarSkin=e,0==this._scrollType?this.scrollType=t.ScrollType.Horizontal:this.scrollType=this._scrollType)}get scrollBar(){return this._scrollBar}set scrollBar(t){this._scrollBar!=t&&(this._scrollBar=t,t&&(this._isVertical=this._scrollBar.isVertical,this._scrollBar.target=this._content,this._scrollBar.on(e.Event.CHANGE,this,this.onScrollBarChange),this.addChild(this._scrollBar),this._content.scrollRect=new e.Rectangle))}get itemRender(){return this._itemRender}set itemRender(t){if(this._itemRender!=t){this._itemRender=t;for(let t=this._cells.length-1;t>-1;t--)this._cells[t].destroy();this._cells.length=0,this._setCellChanged()}}get repeatX(){return this._repeatX>0?this._repeatX:this._repeatX2>0?this._repeatX2:1}set repeatX(t){this._repeatX=t,this._setCellChanged()}get repeatY(){return this._repeatY>0?this._repeatY:this._repeatY2>0?this._repeatY2:1}set repeatY(t){this._repeatY=t,this._setCellChanged()}get spaceX(){return this._spaceX}set spaceX(t){this._spaceX=t,this._setCellChanged()}get spaceY(){return this._spaceY}set spaceY(t){this._spaceY=t,this._setCellChanged()}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){this._selectedIndex!=t&&(this._selectedIndex=t,this.changeSelectStatus(),this.event(e.Event.CHANGE),this.selectHandler&&this.selectHandler.runWith(t),this.startIndex=this._startIndex)}get array(){return this._array}set array(t){this.runCallLater(this.changeCells),this._array=t||[],this._preLen=this._array.length;let e=this._array.length;if(this.totalPage=Math.ceil(e/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<e?this._selectedIndex:e-1,this.startIndex=this._startIndex,this._scrollBar){!this.disableStopScroll&&this._scrollBar.stopScroll();let t=this._isVertical?this.repeatX:this.repeatY,s=this._isVertical?this.repeatY:this.repeatX,i=Math.ceil(e/t);(this._cellOffset>0?this.totalPage+1:this.totalPage)>1&&i>=s?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=s/i,this._scrollBar.setScroll(0,(i-s)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0)}}get selectedItem(){return this._array&&-1!=this._selectedIndex?this._array[this._selectedIndex]:null}set selectedItem(t){this._array&&(this.selectedIndex=this._array.indexOf(t))}get selection(){return this.getCell(this._selectedIndex)}set selection(t){this.selectedIndex=this._startIndex+this._cells.indexOf(t)}get startIndex(){return this._startIndex}set startIndex(t){this._startIndex=t>0?t:0,this.callLater(this.renderItems)}createChildren(){this._content=new n,this._content.hideFlags=e.HideFlags.HideAndDontSave,this.addChild(this._content)}_transChanged(t){super._transChanged(t),0!=(t&e.TransformKind.Size)&&this._setCellChanged()}_getOneCell(){if(0===this._cells.length){let t=this.createItem();if(this._offset.setTo(t._x,t._y),this.cacheContent)return t;this._cells.push(t)}return this._cells[0]}_createItems(t,s,i){let h,l=this._content,r=this._getOneCell(),a=r.width+this._spaceX,o=r.height+this._spaceY;if(this.cacheContent){let s=new n;s.hideFlags=e.HideFlags.HideAndDontSave,s.cacheAs="normal",s.pos((this._isVertical?0:t)*a,(this._isVertical?t:0)*o),this._content.addChild(s),l=s}else{h=[];for(let t=this._cells.length-1;t>-1;t--){let e=this._cells[t];e.removeSelf(),h.push(e)}this._cells.length=0}for(let n=t;n<i;n++)for(let t=0;t<s;t++)h&&h.length?r=h.pop():(r=this.createItem(),r.hideFlags=e.HideFlags.HideAndDontSave),r.x=(this._isVertical?t:n)*a-l._x,r.y=(this._isVertical?n:t)*o-l._y,r.name="item"+(n*s+t),l.addChild(r),this.addCell(r);if(h&&h.length>0)for(let t of h)t.destroy()}_afterInited(){this.initItems()}_bindData(t,e){let s=t._$bindData;for(let t=0,i=s.length;t<i;t++){let i=s[t++],h=s[t++],l=s[t],a=r.getBindFun(l);i[h]=a.call(this,e)}}_sizeChanged(){super._sizeChanged(),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)}_setCellChanged(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))}onScrollStart(){this._usedCache||(this._usedCache=super.cacheAs),super.cacheAs="none",this._scrollBar.once(e.Event.END,this,this.onScrollEnd)}onScrollEnd(){super.cacheAs=this._usedCache||"none"}createItem(){let t,s=[];if("function"==typeof this._itemRender?(t=new this._itemRender,t._skinBaseUrl=this._skinBaseUrl):t=this._itemRender instanceof e.Prefab?this._itemRender.create():this._itemRender._$type||this._itemRender._$prefab?e.HierarchyParser.parse(this._itemRender,{skinBaseUrl:this._skinBaseUrl})[0]:e.PrefabImpl.legacySceneOrPrefab.createComp(this._itemRender,null,null,s),t||(console.warn("cannot create list item"),t=new n),t.hideFlags=e.HideFlags.HideAndDontSave,0==s.length&&t._watchMap){let e=t._watchMap;for(let t in e){let i=e[t];for(let t=0;t<i.length;t++){let e=i[t];s.push(e.comp,e.prop,e.value)}}}return s.length&&(t._$bindData=s),t}changeCells(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChild("scrollBar");let t=this._getOneCell(),e=t.width+this._spaceX||1,s=t.height+this._spaceY||1;this._width>0&&(this._repeatX2=this._isVertical?Math.round(this._width/e):Math.ceil(this._width/e)),this._height>0&&(this._repeatY2=this._isVertical?Math.ceil(this._height/s):Math.round(this._height/s));let i=this._isWidthSet?this._width:e*this.repeatX-this._spaceX,h=this._isHeightSet?this._height:s*this.repeatY-this._spaceY;this._cellSize=this._isVertical?s:e,this._cellOffset=this._isVertical?s*Math.max(this._repeatY2,this._repeatY)-h-this._spaceY:e*Math.max(this._repeatX2,this._repeatX)-i-this._spaceX,this._scrollBar&&(this._isVertical?this._scrollBar.height=h:this._scrollBar.width=i),this.setContentSize(i,h);let l=this._isVertical?this.repeatX:this.repeatY,r=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,l,r),this._createdLine=r,this._array?(this.array=this._array,this.runCallLater(this.renderItems)):this.changeSelectStatus()}}addCell(t){t.on(e.Event.CLICK,this,this.onCellMouse),t.on(e.Event.RIGHT_CLICK,this,this.onCellMouse),t.on(e.Event.MOUSE_OVER,this,this.onCellMouse),t.on(e.Event.MOUSE_OUT,this,this.onCellMouse),t.on(e.Event.MOUSE_DOWN,this,this.onCellMouse),t.on(e.Event.MOUSE_UP,this,this.onCellMouse),this._cells.push(t)}onCellMouse(t){t.type===e.Event.MOUSE_DOWN&&(this._isMoved=!1);let s=t.currentTarget,i=this._startIndex+this._cells.indexOf(s);i<0||(t.type===e.Event.CLICK||t.type===e.Event.RIGHT_CLICK?this.selectEnable&&!this._isMoved?this.selectedIndex=i:this.changeCellState(s,!0,0):t.type!==e.Event.MOUSE_OVER&&t.type!==e.Event.MOUSE_OUT||this._selectedIndex===i||this.changeCellState(s,t.type===e.Event.MOUSE_OVER,0),this.mouseHandler&&this.mouseHandler.runWith([t,i]))}changeCellState(t,e,s){let i=t.getChild("selectBox");i&&(this.selectEnable=!0,i.visible=e,i.index=s)}onScrollBarChange(t=null){this.runCallLater(this.changeCells);let e=this._scrollBar.value,s=this._isVertical?this.repeatX:this.repeatY,i=this._isVertical?this.repeatY:this.repeatX,h=Math.floor(e/this._cellSize);if(this.cacheContent){let t=i+1;this._createdLine-h<t&&(this._createItems(this._createdLine,s,this._createdLine+t),this.renderItems(this._createdLine*s,0),this._createdLine+=t)}else{let t,e,l=h*s,r=0,a=!0,n=0;l>this._startIndex?(r=l-this._startIndex,n=this._startIndex+s*(i+1),this._isMoved=!0):l<this._startIndex&&(r=this._startIndex-l,a=!1,n=this._startIndex-1,this._isMoved=!0);for(let i=0;i<r;i++){a?(t=this._cells.shift(),this._cells[this._cells.length]=t,e=n+i):(t=this._cells.pop(),this._cells.unshift(t),e=n-i);let h=Math.floor(e/s)*this._cellSize;this._isVertical?t.y=h:t.x=h,this.renderItem(t,e)}this._startIndex=l,this.changeSelectStatus()}let l=this._content._scrollRect;this._isVertical?(l.y=e-this._offset.y,l.x=-this._offset.x):(l.y=-this._offset.y,l.x=e-this._offset.x),this._content.scrollRect=l}posCell(t,e){if(!this._scrollBar)return;let s=this._isVertical?this.repeatX:this.repeatY,i=Math.floor(e/s)*this._cellSize;this._isVertical?t._y=i:t.x=i}changeSelectStatus(){for(let t=0,e=this._cells.length;t<e;t++)this.changeCellState(this._cells[t],this._selectedIndex===this._startIndex+t,1)}renderItems(t=0,e=0){for(let s=t,i=e||this._cells.length;s<i;s++)this.renderItem(this._cells[s],this._startIndex+s);this.changeSelectStatus()}renderItem(t,s){!this._array||s>=0&&s<this._array.length?(t.visible=!0,this._array&&(t._$bindData?(t._dataSource=this._array[s],this._bindData(t,this._array[s])):t.dataSource=this._array[s]),this.cacheContent||this.posCell(t,s),this.hasListener(e.Event.RENDER)&&this.event(e.Event.RENDER,[t,s]),this.renderHandler&&this.renderHandler.runWith([t,s])):(t.visible=!1,t.dataSource=null)}commitMeasure(){this.runCallLater(this.changeCells)}updateArray(t){if(this._array=t,this._array){let t=this._preLen-this._startIndex;t>=0&&this.renderItems(t),this._preLen=this._array.length}if(this._scrollBar){let e=t.length,s=this._isVertical?this.repeatX:this.repeatY,i=this._isVertical?this.repeatY:this.repeatX,h=Math.ceil(e/s);h>=i&&(this._scrollBar.thumbPercent=i/h,this._scrollBar.slider._max=(h-i)*this._cellSize+this._cellOffset)}}onAfterDeserialize(){super.onAfterDeserialize(),this.initItems()}initItems(){if(!this._itemRender&&null!=this.getChild("item0")){let t;this.repeatX=1,t=0;for(let e=0;e<1e4;e++){let s=this.getChild("item"+e);if(!s)break;this.addCell(s),t++}this.repeatY=t}}setContentSize(t,s){if(this._content.width=t,this._content.height=s,this._scrollBar){let i=this._content.scrollRect;i||(i=new e.Rectangle),i.setTo(-this._offset.x,-this._offset.y,t,s),this._content.scrollRect=i}this.event(e.Event.RESIZE)}set_dataSource(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.selectedIndex=parseInt(t):t instanceof Array?this.array=t:super.set_dataSource(t)}refresh(){this.array=this._array}getItem(t){return this._array&&t>-1&&t<this._array.length?this._array[t]:null}changeItem(t,e){t>-1&&this._array&&t<this._array.length&&(this._array[t]=e,t>=this._startIndex&&t<this._startIndex+this._cells.length&&this.renderItem(this.getCell(t),t))}setItem(t,e){this.changeItem(t,e)}addItem(t){this.array?this._array.push(t):this.array=[t],this.array=this._array}addItemAt(t,e){this._array.splice(e,0,t),this.array=this._array}deleteItem(t){this._array&&(this._array.splice(t,1),this.array=this._array)}getCell(t){return this.runCallLater(this.changeCells),t>-1&&this._cells?this._cells[(t-this._startIndex)%this._cells.length]:null}scrollTo(t){if(this._scrollBar){let e=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(t/e)*this._cellSize}else this.startIndex=t}tweenTo(t,s=200,i=null){if(this._scrollBar){this._scrollBar.stopScroll();let h=this._isVertical?this.repeatX:this.repeatY;e.Tween.to(this._scrollBar,{value:Math.floor(t/h)*this._cellSize},s,null,i,0,!0)}else this.startIndex=t,i&&i.run()}destroy(t=!0){this._content&&this._content.destroy(t),this._scrollBar&&this._scrollBar.destroy(t),super.destroy(t),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null}}class y extends a{get skin(){return this._button.skin}set skin(t){this._button.skin!=t&&(this._button.skin=t,this._listChanged=!0)}get itemPadding(){return this._itemPadding.join(",")}set itemPadding(t){this._itemPadding=r.fillArray(this._itemPadding,t,Number)}get labels(){return this._labels.join(",")}set labels(t){this._labels.length>0&&(this.selectedIndex=-1),t?this._labels=t.split(","):this._labels.length=0,this._itemChanged=!0}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){this._selectedIndex!=t&&(this._selectedIndex=t,this._labels.length>0?this.changeSelected():this.callLater(this.changeSelected),this.event(e.Event.CHANGE,e.Event.EMPTY),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}get defaultLabel(){return this._defaultLabel}set defaultLabel(t){this._defaultLabel=t,this._selectedIndex<0&&(this._button.label=t)}get selectHandler(){return this._selectHandler}set selectHandler(t){this._selectHandler=t}get selectedLabel(){return this._selectedIndex>-1&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:this.defaultLabel}set selectedLabel(t){this.selectedIndex=this._labels.indexOf(t)}get visibleNum(){return this._visibleNum}set visibleNum(t){this._visibleNum=t,this._listChanged=!0}get itemHeight(){return this._itemHeight}set itemHeight(t){this._itemHeight=t,this._listChanged=!0}get itemColors(){return this._itemColors.join(",")}set itemColors(t){this._itemColors=r.fillArray(this._itemColors,t,String),this._listChanged=!0}get itemSize(){return this._itemSize}set itemSize(t){this._itemSize=t,this._listChanged=!0}get isOpen(){return this._isOpen}set isOpen(t){if(this._isOpen!=t)if(this._isOpen=t,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var s=this.localToGlobal(e.Point.TEMP.setTo(0,0)),i=s.y+this._button.height;i=i+this._listHeight<=e.ILaya.stage.height||s.y-this._listHeight<0?i:s.y-this._listHeight,this._list.pos(s.x,i),this._list.zOrder=1001,e.ILaya.stage.addChild(this._list),e.ILaya.stage.once(e.Event.MOUSE_DOWN,this,this.removeList),e.ILaya.stage.on(e.Event.MOUSE_WHEEL,this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}get scrollType(){return this._scrollType}set scrollType(t){this._scrollType=t}get scrollBarSkin(){return this._scrollBarSkin}set scrollBarSkin(t){this._scrollBarSkin=t}get sizeGrid(){return this._button.sizeGrid}set sizeGrid(t){this._button.sizeGrid=t}get scrollBar(){return this.list.scrollBar}get button(){return this._button}get list(){return this._list||this._createList(),this._list}set list(t){t&&(t.removeSelf(),this._isCustomList=!0,this._list=t,this._setListEvent(t),this._itemHeight=t.getCell(0).height+t.spaceY)}get labelColors(){return this._button.labelColors}set labelColors(t){this._button.labelColors!=t&&(this._button.labelColors=t)}get labelPadding(){return this._button.text.padding.join(",")}set labelPadding(t){this._button.text.padding=r.fillArray(o.labelPadding,t,Number)}get labelSize(){return this._button.text.fontSize}set labelSize(t){this._button.text.fontSize=t}get labelBold(){return this._button.text.bold}set labelBold(t){this._button.text.bold=t}get labelFont(){return this._button.text.font}set labelFont(t){this._button.text.font=t}get stateNum(){return this._button.stateNum}set stateNum(t){this._button.stateNum=t}constructor(t=null,e=null){super(),this._visibleNum=6,this._itemSize=18,this._labels=[],this._defaultLabel="",this._selectedIndex=-1,this._scrollType=0,this.itemRender=null,this._itemColors=o.comboBoxItemColors,this._itemPadding=[3,3,3,10],this.skin=t,this.labels=e}createChildren(){this._button=new _,this._button.hideFlags=e.HideFlags.HideAndDontSave,this._button.text.align="left",this._button.labelPadding="0,0,0,10",this._button.on(e.Event.MOUSE_DOWN,this,this.onButtonMouseDown),this.addChild(this._button)}_createList(){this._list=new b,this._list.hideFlags=e.HideFlags.HideAndDontSave,this._list.scrollType=this._scrollType,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)}_setListEvent(t){this._list.selectEnable=!0,this._list.on(e.Event.MOUSE_DOWN,this,this.onListDown),this._list.mouseHandler=e.Handler.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on(e.Event.MOUSE_DOWN,this,this.onScrollBarDown)}_transChanged(t){super._transChanged(t),0!=(t&e.TransformKind.Width)&&(this._button.width=this.width,this._itemChanged=!0,this._listChanged=!0),0!=(t&e.TransformKind.Height)&&(this._button.height=this.height)}_onStageMouseWheel(t){this._list&&!this._list.contains(t.target)&&this.removeList(null)}removeList(t){e.ILaya.stage.off(e.Event.MOUSE_DOWN,this,this.removeList),e.ILaya.stage.off(e.Event.MOUSE_WHEEL,this,this._onStageMouseWheel),this.isOpen=!1}onListDown(t){t.stopPropagation()}onScrollBarDown(t){t.stopPropagation()}onButtonMouseDown(t){this.callLater(this.switchTo,[!this._isOpen])}measureWidth(){return this._button.width}measureHeight(){return this._button.height}changeList(){this._listChanged=!1;var t=this.width-2,e=this._itemColors[2];this._itemHeight=this._itemHeight?this._itemHeight:this._itemSize+6;let s=this.itemPadding?this.itemPadding:"3,3,3,`10`";this._list.itemRender=this.itemRender||{_$type:"Box",_$child:[{_$type:"Label",name:"label",x:1,padding:s,width:t,height:this._itemHeight,fontSize:this._itemSize,color:e}]},this._list.repeatY=this._visibleNum,this._list.refresh()}onlistItemMouse(t,s){let i=t.type;if(i===e.Event.MOUSE_OVER||i===e.Event.MOUSE_OUT){if(this._isCustomList)return;let t=this._list.getCell(s);if(!t)return;let h=t.getChild("label");h&&(i===e.Event.ROLL_OVER?(h.bgColor=this._itemColors[0],h.color=this._itemColors[1]):(h.bgColor=null,h.color=this._itemColors[2]))}else i===e.Event.CLICK&&(this.selectedIndex=s,this.isOpen=!1)}switchTo(t){this.isOpen=t}changeOpen(){this.isOpen=!this._isOpen}changeItem(){if(this._itemChanged=!1,this._listHeight=this._labels.length>0?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var t=this._list.graphics;t.clear(),t.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}let e=this._list.array||[];e.length=0;for(let t=0,s=this._labels.length;t<s;t++)e.push({label:this._labels[t]});this._list.size(this.width,this._listHeight),this._list.array=e}changeSelected(){this._button.label=this.selectedLabel}destroy(t=!0){e.ILaya.stage.off(e.Event.MOUSE_DOWN,this,this.removeList),e.ILaya.stage.off(e.Event.MOUSE_WHEEL,this,this._onStageMouseWheel),super.destroy(t),this._button&&this._button.destroy(t),this._list&&this._list.destroy(t),this._button=null,this._list=null,this._itemColors=null,this._itemPadding=null,this._itemHeight=null,this._labels=null,this._selectHandler=null,this._defaultLabel=null}set_dataSource(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.selectedIndex=parseInt(t):t instanceof Array?this.labels=t.join(","):super.set_dataSource(t)}}class x extends e.Scene{static regUI(t,s){e.ILaya.loader.cacheRes(t,s)}constructor(){super(),this._watchMap={},this._scene=null,this.createChildren()}createChildren(){}changeData(t){let e=this._watchMap[t];if(e)for(let t=0,s=e.length;t<s;t++){e[t].exe(this)}}measureWidth(){for(var t=0,e=this.numChildren-1;e>-1;e--){var s=this.getChildAt(e);s._visible&&(t=Math.max(s._x+s.width*s.scaleX,t))}return t}measureHeight(){let t=0;for(let e=this.numChildren-1;e>-1;e--){let s=this.getChildAt(e);s._visible&&(t=Math.max(s._y+s.height*s.scaleY,t))}return t}set_dataSource(t){this._dataSource=t;for(let e in t){let s=this.getChild(e);s instanceof a?s.dataSource=t[e]:!(e in this)||this[e]instanceof Function||(this[e]=t[e])}}}x.uiMap={};class B extends e.Sprite{constructor(){super(),this.maskLayer=new e.Sprite,this.popupEffect=t=>{t.scale(1,1),null!=t._effectTween&&e.Tween.kill(t._effectTween),t._effectTween=e.Tween.from(t,{x:e.ILaya.stage.width/2,y:e.ILaya.stage.height/2,scaleX:0,scaleY:0},300,e.Ease.backOut,e.Handler.create(this,this.doOpen,[t]))},this.closeEffect=t=>{null!=t._effectTween&&e.Tween.kill(t._effectTween),t._effectTween=e.Tween.to(t,{x:e.ILaya.stage.width/2,y:e.ILaya.stage.height/2,scaleX:0,scaleY:0},300,e.Ease.strongOut,e.Handler.create(this,this.doClose,[t]))},this.popupEffectHandler=new e.Handler(this,this.popupEffect),this.closeEffectHandler=new e.Handler(this,this.closeEffect),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,e.ILaya.stage.addChild(this),e.ILaya.stage.on(e.Event.RESIZE,this,this._onResize),s.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}_closeOnSide(){var t=this.getChildAt(this.numChildren-1);t instanceof k&&t.close("side")}_onResize(t=null){var i=this.maskLayer.width=e.ILaya.stage.width,h=this.maskLayer.height=e.ILaya.stage.height;this.lockLayer&&this.lockLayer.size(i,h),this.maskLayer.graphics.clear(!0),this.maskLayer.graphics.drawRect(0,0,i,h,s.popupBgColor),this.maskLayer.alpha=s.popupBgAlpha;for(var l=this.numChildren-1;l>-1;l--){var r=this.getChildAt(l);r.isPopupCenter&&this._centerDialog(r)}}_centerDialog(t){t.x=Math.round((e.ILaya.stage.width-t.width>>1)+t.pivotX),t.y=Math.round((e.ILaya.stage.height-t.height>>1)+t.pivotY)}_clearDialogEffect(t){t._effectTween&&(e.Tween.kill(t._effectTween),t._effectTween=null)}_closeAll(){for(var t=this.numChildren-1;t>-1;t--){var e=this.getChildAt(t);e&&null!=e.close&&this.doClose(e)}}_checkMask(){if(!this._destroyed){this.maskLayer.removeSelf();for(var t=this.numChildren-1;t>-1;t--){var e=this.getChildAt(t);if(e&&e.isModal)return void this.addChildAt(this.maskLayer,t)}}}setLockView(t){this.lockLayer||(this.lockLayer=new n,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(e.ILaya.stage.width,e.ILaya.stage.height)),this.lockLayer.removeChildren(),t&&(t.centerX=t.centerY=0,this.lockLayer.addChild(t))}open(t,s=!1,i=!1){s&&this._closeAll(),this._clearDialogEffect(t),t.isPopupCenter&&this._centerDialog(t),this.addChild(t),(t.isModal||this._getBit(e.NodeFlags.HAS_ZORDER))&&e.ILaya.timer.callLater(this,this._checkMask),i&&null!=t.popupEffect?t.popupEffect.runWith(t):this.doOpen(t),this.event(e.Event.OPEN)}doOpen(t){t.onOpened(t._param)}lock(t){this.lockLayer&&(t?this.addChild(this.lockLayer):this.lockLayer.removeSelf())}close(t){this._clearDialogEffect(t),t.isShowEffect&&null!=t.closeEffect?t.closeEffect.runWith([t]):this.doClose(t),this.event(e.Event.CLOSE)}doClose(t){t.removeSelf(),t.isModal&&this._checkMask(),t.closeHandler&&t.closeHandler.runWith(t.closeType),t.onClosed(t.closeType),t.autoDestroyAtClosed&&t.destroy()}closeAll(){this._closeAll(),this.event(e.Event.CLOSE)}getDialogsByGroup(t){for(var e=[],s=this.numChildren-1;s>-1;s--){var i=this.getChildAt(s);i&&i.group===t&&e.push(i)}return e}closeByGroup(t){for(var e=[],s=this.numChildren-1;s>-1;s--){var i=this.getChildAt(s);i&&i.group===t&&(i.close(),e.push(i))}return e}}class k extends x{static get manager(){return k._manager=k._manager||new B}static set manager(t){k._manager=t}static setLockView(t){k.manager.setLockView(t)}static lock(t){k.manager.lock(t)}static closeAll(){k.manager.closeAll()}static getDialogsByGroup(t){return k.manager.getDialogsByGroup(t)}static closeByGroup(t){return k.manager.closeByGroup(t)}get dragArea(){return this._dragArea?this._dragArea.toString():null}set dragArea(t){if(t){var s=r.fillArray([0,0,0,0],t,Number);this._dragArea=new e.Rectangle(s[0],s[1],s[2],s[3]),this.on(e.Event.MOUSE_DOWN,this,this._onMouseDown)}else this._dragArea=null,this.off(e.Event.MOUSE_DOWN,this,this._onMouseDown)}get isPopup(){return null!=this.parent}get zOrder(){return super.zOrder}set zOrder(t){super.zOrder=t,k.manager._checkMask()}constructor(){super(),this.isShowEffect=!0,this.isPopupCenter=!0,this.popupEffect=k.manager.popupEffectHandler,this.closeEffect=k.manager.closeEffectHandler,this._dealDragArea(),this.on(e.Event.CLICK,this,this._onClick)}_dealDragArea(){var t=this.getChild("drag");t&&(this.dragArea=t._x+","+t._y+","+t.width+","+t.height,t.removeSelf())}_onMouseDown(t){var e=this.getMousePoint();this._dragArea.contains(e.x,e.y)?this.startDrag():this.stopDrag()}_onClick(t){var e=t.target;if(e)switch(e.name){case k.CLOSE:case k.CANCEL:case k.SURE:case k.NO:case k.OK:case k.YES:return void this.close(e.name)}}open(t=!0,e=null){this._dealDragArea(),this._param=e,k.manager.open(this,t,this.isShowEffect),k.manager.lock(!1)}close(t=null){this.closeType=t,k.manager.close(this)}destroy(t=!0){this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this._dragArea=null,super.destroy(t),k.manager._checkMask()}show(t=!1,e=!0){this._open(!1,t,e)}popup(t=!1,e=!0){this._open(!0,t,e)}_open(t,e,s){this.isModal=t,this.isShowEffect=s,k.manager.lock(!0),this.open(e)}}k.CLOSE="close",k.CANCEL="cancel",k.SURE="sure",k.NO="no",k.YES="yes",k.OK="ok";class E extends u{get index(){return this._index}set index(t){this._index=t}get sheet(){return this._sheet}set sheet(t){t+="",this._sheet=t;var e=t.split(" ");this._clipX=String(e[0]).length,this.clipY=e.length,this._indexMap={};for(var s=0;s<this._clipY;s++)for(var i=e[s].split(""),h=0,l=i.length;h<l;h++)this._indexMap[i[h]]=s*this._clipX+h}get value(){return this._valueArr?this._valueArr:""}set value(t){t+="",this._valueArr=t,this.callLater(this.changeValue)}get direction(){return this._direction}set direction(t){this._direction=t,this.callLater(this.changeValue)}get spaceX(){return this._spaceX}set spaceX(t){this._spaceX=t,"horizontal"===this._direction&&this.callLater(this.changeValue)}get spaceY(){return this._spaceY}set spaceY(t){this._spaceY=t,"horizontal"!==this._direction&&this.callLater(this.changeValue)}get align(){return this._align}set align(t){this._align=t,this.callLater(this.changeValue)}constructor(t=null,e=null){super(),this._valueArr="",this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,t&&(this.skin=t),e&&(this.sheet=e)}_transChanged(t){super._transChanged(t),0!=(t&e.TransformKind.Size)&&this.callLater(this.changeValue)}loadComplete(t,e){super.loadComplete(t,e),this.callLater(this.changeValue)}changeValue(){if(!this._sources)return;if(!this._valueArr)return;let t;if(this.graphics.clear(!0),t=this._sources[0],!t)return;var e="horizontal"===this._direction;e?(this._wordsW=this._valueArr.length*(t.sourceWidth+this.spaceX),this._wordsH=t.sourceHeight):(this._wordsW=t.sourceWidth,this._wordsH=(t.sourceHeight+this.spaceY)*this._valueArr.length);let s=0;if(this._isWidthSet)switch(this._align){case"center":s=.5*(this._width-this._wordsW);break;case"right":s=this._width-this._wordsW;break;default:s=0}for(let i=0,h=this._valueArr.length;i<h;i++){let h=this._indexMap[this._valueArr.charAt(i)];t=this._sources[h],t&&(e?this.graphics.drawImage(t,s+i*(t.sourceWidth+this.spaceX),0,t.sourceWidth,t.sourceHeight):this.graphics.drawImage(t,0+s,i*(t.sourceHeight+this.spaceY),t.sourceWidth,t.sourceHeight))}this._isWidthSet||(this._widget.resetLayoutX(),this.callLater(this._sizeChanged)),this._isHeightSet||(this._widget.resetLayoutY(),this.callLater(this._sizeChanged))}measureWidth(){return this._wordsW}measureHeight(){return this._wordsH}destroy(t=!0){this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),super.destroy(t)}}class w extends n{constructor(){super(...arguments),this._space=0,this._align="none",this._itemChanged=!1}get space(){return this._space}set space(t){this._space=t,this._setItemChanged()}get align(){return this._align}set align(t){this._align=t,this._setItemChanged()}_setItemChanged(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))}changeItems(){this._itemChanged=!1}sortItem(t){t&&t.sort((function(t,e){return t.y-e.y}))}onResize(t){this._setItemChanged()}_childChanged(t){super._childChanged(t),t&&(t.parent==this?t.on(e.Event.RESIZE,this,this.onResize):t.off(e.Event.RESIZE,this,this.onResize),this._setItemChanged())}refresh(){this._setItemChanged()}}class L extends w{_transChanged(t){super._transChanged(t),0!=(t&e.TransformKind.Height)&&this.callLater(this.changeItems)}sortItem(t){t&&t.sort((function(t,e){return t.x-e.x}))}changeItems(){this._itemChanged=!1;let t=[],e=0;for(let s=0,i=this.numChildren;s<i;s++){let i=this.getChildAt(s);i&&(i.x=0,t.push(i),e=this._isHeightSet?this._height:Math.max(e,i.height*i.scaleY))}this.sortItem(t);let s=0;for(let i=0,h=t.length;i<h;i++){let h=t[i];h.x=s,s+=h.width*h.scaleX+this._space,this._align==L.TOP?h.y=0:this._align==L.MIDDLE?h.y=.5*(e-h.height*h.scaleY):this._align==L.BOTTOM&&(h.y=e-h.height*h.scaleY)}this._sizeChanged()}}L.NONE="none",L.TOP="top",L.MIDDLE="middle",L.BOTTOM="bottom";class I extends f{constructor(t=null){super(t),this.isVertical=!1}}class T extends n{constructor(){super(),this._usedCache=null,this._elasticEnabled=!1,this._scrollType=0,this.width=this.height=100}destroy(t=!0){super.destroy(t),this._vScrollBar=null,this._hScrollBar=null,this._content=null}createChildren(){this._content=new M,this._content.hideFlags=e.HideFlags.HideAndDontSave,this.addChild(this._content),this._setContainer(this._content)}_panelChildChanged(t){t&&(t.parent?t.on(e.Event.RESIZE,this,this._setScrollChanged):t.off(e.Event.RESIZE,this,this._setScrollChanged),this._setScrollChanged())}changeScroll(){this._scrollChanged=!1;var t=this.contentWidth||1,e=this.contentHeight||1,s=this._vScrollBar,i=this._hScrollBar,h=s&&e>this._height,l=i&&t>this._width,r=h?this._width-s.width:this._width,a=l?this._height-i.height:this._height;s&&(s.height=this._height-(l?i.height:0),s.scrollSize=Math.max(.033*this._height,1),s.thumbPercent=a/e,s.setScroll(0,e-a)),i&&(i.width=this._width-(h?s.width:0),i.scrollSize=Math.max(.033*this._width,1),i.thumbPercent=r/t,i.setScroll(0,t-r))}_sizeChanged(){super._sizeChanged(),this.setContentSize(this._width,this._height)}get contentWidth(){let t=0;for(let e of this.children)t=Math.max(e._x+e.width*e.scaleX-e.pivotX,t);return t}get contentHeight(){let t=0;for(let e of this.children)t=Math.max(e._y+e.height*e.scaleY-e.pivotY,t);return t}setContentSize(t,s){let i=this._content;i.width=t,i.height=s,i._scrollRect||(i.scrollRect=new e.Rectangle),i._scrollRect.setTo(0,0,t,s),i.scrollRect=i.scrollRect}_transChanged(t){super._transChanged(t),0!=(t&e.TransformKind.Size)&&this._setScrollChanged()}get scrollType(){return this._scrollType}set scrollType(e){this._scrollType=e,this._scrollType==t.ScrollType.None?(this._hScrollBar&&(this._hScrollBar.destroy(),this._hScrollBar=null),this._vScrollBar&&(this._vScrollBar.destroy(),this._vScrollBar=null)):this._scrollType==t.ScrollType.Horizontal?(this._vScrollBar&&(this._vScrollBar.destroy(),this._vScrollBar=null),this._hScrollBar?this._hScrollBar.skin=this._hScrollBarSkin:this.createHScrollBar()):this._scrollType==t.ScrollType.Vertical?(this._hScrollBar&&(this._hScrollBar.destroy(),this._hScrollBar=null),this._vScrollBar?this._vScrollBar.skin=this._vScrollBarSkin:this.createVScrollBar()):(this._hScrollBar?this._hScrollBar.skin=this._hScrollBarSkin:this.createHScrollBar(),this._vScrollBar?this._vScrollBar.skin=this._vScrollBarSkin:this.createVScrollBar())}createHScrollBar(){let t=this._hScrollBar=new v;t.hideFlags=e.HideFlags.HideAndDontSave,t.on(e.Event.CHANGE,this,this.onScrollBarChange,[t]),t.target=this._content,t.elasticDistance=this._elasticEnabled?200:0,t.bottom=0,t._skinBaseUrl=this._skinBaseUrl,t.skin=this._hScrollBarSkin,t.on(e.Event.LOADED,this,this._setScrollChanged),this._addChild(t),this._setScrollChanged()}createVScrollBar(){let t=this._vScrollBar=new C;t.hideFlags=e.HideFlags.HideAndDontSave,t.on(e.Event.CHANGE,this,this.onScrollBarChange,[t]),t.target=this._content,t.elasticDistance=this._elasticEnabled?200:0,t.right=0,t._skinBaseUrl=this._skinBaseUrl,t.skin=this._vScrollBarSkin,t.on(e.Event.LOADED,this,this._setScrollChanged),this._addChild(t),this._setScrollChanged()}get vScrollBarSkin(){return this._vScrollBarSkin}set vScrollBarSkin(e){""==e&&(e=null),this._vScrollBarSkin!=e&&(this._vScrollBarSkin=e,0==this._scrollType?this.scrollType=t.ScrollType.Vertical:this._scrollType==t.ScrollType.Horizontal?this.scrollType=t.ScrollType.Both:this.scrollType=this._scrollType)}get hScrollBarSkin(){return this._hScrollBarSkin}set hScrollBarSkin(e){""==e&&(e=null),this._hScrollBarSkin!=e&&(this._hScrollBarSkin=e,0==this._scrollType?this.scrollType=t.ScrollType.Horizontal:this._scrollType==t.ScrollType.Vertical&&(this.scrollType=t.ScrollType.Both),this.scrollType=this._scrollType)}get vScrollBar(){return this._vScrollBar}get hScrollBar(){return this._hScrollBar}get content(){return this._content}onScrollBarChange(t){let e=this._content._scrollRect;if(e){let s=Math.round(t.value);t.isVertical?e.y=s:e.x=s,this._content.scrollRect=e}}scrollTo(t=0,e=0){this.vScrollBar&&(this.vScrollBar.value=e),this.hScrollBar&&(this.hScrollBar.value=t)}refresh(){this.changeScroll()}get cacheAs(){return super.cacheAs}set cacheAs(t){super.cacheAs=t,this._usedCache=null,"none"!==t?(this._hScrollBar&&this._hScrollBar.on(e.Event.START,this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on(e.Event.START,this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off(e.Event.START,this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off(e.Event.START,this,this.onScrollStart))}get elasticEnabled(){return this._elasticEnabled}set elasticEnabled(t){this._elasticEnabled=t,this._vScrollBar&&(this._vScrollBar.elasticDistance=t?200:0),this._hScrollBar&&(this._hScrollBar.elasticDistance=t?200:0)}onScrollStart(){this._usedCache||(this._usedCache=super.cacheAs),super.cacheAs="none",this._hScrollBar&&this._hScrollBar.once(e.Event.END,this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once(e.Event.END,this,this.onScrollEnd)}onScrollEnd(){super.cacheAs=this._usedCache}_setScrollChanged(){this._scrollChanged||this._destroyed||(this._scrollChanged=!0,this.callLater(this.changeScroll))}}class M extends n{_childChanged(t){super._childChanged(t),this._parent&&this._parent._panelChildChanged(t)}}class H extends a{get skin(){return this._skin}set skin(t){this._skin!=t&&this._setSkin(t)}get value(){return this._value}set value(t){this._value!=t&&(t=t>1?1:t<0?0:t,this._value=t,this.callLater(this.changeValue),this.event(e.Event.CHANGE),this.changeHandler&&this.changeHandler.runWith(t))}get bar(){return this._bar}get bg(){return this._bg}get sizeGrid(){return this._bg.sizeGrid}set sizeGrid(t){this._bg.sizeGrid=this._bar.sizeGrid=t}constructor(t=null){super(),this._value=.5,this.skin=t}createChildren(){this._bg=new S,this._bg.left=0,this._bg.right=0,this._bg.top=0,this._bg.bottom=0,this._bg.hideFlags=e.HideFlags.HideAndDontSave,this.addChild(this._bg),this._bar=new S,this._bar.hideFlags=e.HideFlags.HideAndDontSave,this._bar.top=0,this._bar.bottom=0,this.addChild(this._bar)}_setSkin(t){return this._skin=t,t?e.AssetDb.inst.resolveURL(t).then((t=>this._destroyed?null:(this._skinBaseUrl&&(t=e.URL.formatURL(t,this._skinBaseUrl)),Promise.all([this._bg._setSkin(t),this._bar._setSkin(e.Utils.replaceFileExtension(t,"$bar.png",!0))]).then((()=>this._skinLoaded()))))):(this._bg.skin=null,this._bar.skin=null,this._skinLoaded(),Promise.resolve())}_skinLoaded(){this._destroyed||(this.callLater(this.changeValue),this._sizeChanged(),this.event(e.Event.LOADED))}measureWidth(){return this._bg.width}measureHeight(){return this._bg.height}changeValue(){if(this.sizeGrid){let t=this.sizeGrid.split(","),e=parseInt(t[3]);isNaN(e)&&(e=0);let s=parseInt(t[1]);isNaN(s)&&(s=0);let i=(this.width-e-s)*this._value;this._bar.width=e+s+i,this._bar.visible=this._bar.width>e+s}else this._bar.width=this.width*this._value}_transChanged(t){super._transChanged(t),0!=(t&e.TransformKind.Width)&&this.callLater(this.changeValue)}set_dataSource(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.value=Number(t):super.set_dataSource(t)}destroy(t=!0){super.destroy(t),this._bg&&this._bg.destroy(t),this._bar&&this._bar.destroy(t),this._bg=this._bar=null,this.changeHandler=null}}class O extends _{get value(){return null!=this._value?this._value:this.label}set value(t){this._value=t}constructor(t=null,e=""){super(t,e),this.toggle=!1,this._autoSize=!1}_transChanged(t){super._transChanged(t),0!=(t&e.TransformKind.Width)&&(this._autoSize||(this._text.width=this._width-this._text.x))}preinitialize(){super.preinitialize(),this.toggle=!1,this._autoSize=!1}initialize(){super.initialize(),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=null,this.on(e.Event.CLICK,this,this.onClick)}onClick(t){this.selected=!0}changeClips(){super.changeClips(),this._autoSize||(this._text.width=this.width-this._text.x)}}class z extends n{get selectedIndex(){return this._selectedIndex}set selectedIndex(t){this._selectedIndex!=t&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=t,this.setSelect(t,!0),this.event(e.Event.CHANGE),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}get skin(){return this._skin}set skin(t){""==t&&(t=null),this._skin!=t&&this._setSkin(t)}get labels(){return this._labels}set labels(t){if(""==t&&(t=null),this._labels!=t){this._labels=t;let s=0,i=this.numChildren;for(;s<i;){let t=this.getChildAt(s);t.hasHideFlag(e.HideFlags.HideAndDontSave)&&t.name&&t.name.startsWith("item")?(this.removeChildAt(s),i--):s++}if(this._setLabelChanged(),this._labels){let t=this._labels.split(",");for(let s=0,i=t.length;s<i;s++){let i=this.createItem(this._skin,t[s]);i.name="item"+s,i.hideFlags=e.HideFlags.HideAndDontSave,this.addChild(i)}}this.initItems()}}get labelColors(){return this._labelColors}set labelColors(t){this._labelColors!=t&&(this._labelColors=t,this._setLabelChanged())}get labelStroke(){return this._labelStroke}set labelStroke(t){this._labelStroke!=t&&(this._labelStroke=t,this._setLabelChanged())}get labelStrokeColor(){return this._labelStrokeColor}set labelStrokeColor(t){this._labelStrokeColor!=t&&(this._labelStrokeColor=t,this._setLabelChanged())}get strokeColors(){return this._strokeColors}set strokeColors(t){this._strokeColors!=t&&(this._strokeColors=t,this._setLabelChanged())}get labelSize(){return this._labelSize}set labelSize(t){this._labelSize!=t&&(this._labelSize=t,this._setLabelChanged())}get stateNum(){return this._stateNum}set stateNum(t){this._stateNum!=t&&(this._stateNum=t,this._setLabelChanged())}get labelBold(){return this._labelBold}set labelBold(t){this._labelBold!=t&&(this._labelBold=t,this._setLabelChanged())}get labelFont(){return this._labelFont}set labelFont(t){this._labelFont!=t&&(this._labelFont=t,this._setLabelChanged())}get labelPadding(){return this._labelPadding}set labelPadding(t){this._labelPadding!=t&&(this._labelPadding=t,this._setLabelChanged())}get direction(){return this._direction}set direction(t){this._direction=t,this._setLabelChanged()}get space(){return this._space}set space(t){this._space=t,this._setLabelChanged()}get items(){return this._items}get selection(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null}set selection(t){this.selectedIndex=this._items.indexOf(t)}constructor(t=null,e=null){super(),this._selectedIndex=-1,this._direction="horizontal",this._space=0,this._items=[],this.skin=e,this.labels=t}preinitialize(){this.mouseEnabled=!0}_afterInited(){this.initItems()}_setSkin(t){return this._skin=t,t?(this._skinBaseUrl&&(t=e.URL.formatURL(t,this._skinBaseUrl)),e.Loader.getRes(t)?(this._skinLoaded(),Promise.resolve()):e.ILaya.loader.load(t,e.Loader.IMAGE).then((t=>this._skinLoaded()))):(this._skinLoaded(),Promise.resolve())}_skinLoaded(){this._destroyed||(this._setLabelChanged(),this.event(e.Event.LOADED))}_setLabelChanged(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))}itemClick(t){this.selectedIndex=t}createItem(t,e){return null}changeLabels(){if(this._labelChanged=!1,this._items)for(var t=0,e=0,s=this._items.length;e<s;e++){var i=this._items[e];this._skin&&(i.skin=this._skin),this._labelColors&&(i.labelColors=this._labelColors),null!=this._labelSize&&(i.labelSize=this._labelSize),null!=this._labelStroke&&(i.labelStroke=this._labelStroke),this._labelStrokeColor&&(i.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(i.strokeColors=this._strokeColors),this._labelBold&&(i.labelBold=this._labelBold),this._labelPadding&&(i.labelPadding=this._labelPadding),this._labelAlign&&(i.labelAlign=this._labelAlign),null!=this._stateNum&&(i.stateNum=this._stateNum),this._labelFont&&(i.labelFont=this._labelFont),"horizontal"===this._direction?(i.y=0,i.x=t,t+=i.width+this._space):(i.x=0,i.y=t,t+=i.height+this._space)}this._sizeChanged()}commitMeasure(){this.runCallLater(this.changeLabels)}setSelect(t,e){this._items&&t>-1&&t<this._items.length&&(this._items[t].selected=e)}destroy(t=!0){super.destroy(t),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null}addItem(t,e=!0){let s=t,i=this._items.length;if(s.name="item"+i,this.addChild(s),this.initItems(),e&&i>0){let t=this._items[i-1];"horizontal"==this._direction?s.x=t._x+t.width+this._space:s.y=t._y+t.height+this._space}else e&&(s.x=0,s.y=0);return i}delItem(t,e=!0){var s=this._items.indexOf(t);if(-1!=s){let i=t;this.removeChild(i);for(let t=s+1,h=this._items.length;t<h;t++){let s=this._items[t];s.name="item"+(t-1),e&&("horizontal"==this._direction?s.x-=i.width+this._space:s.y-=i.height+this._space)}if(this.initItems(),this._selectedIndex>-1){let t=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1;this._selectedIndex=-1,this.selectedIndex=t}}}onAfterDeserialize(){super.onAfterDeserialize(),this._labels||this.initItems()}initItems(){this._items.length=0;for(let t=0;t<1e4;t++){let s=this.getChild("item"+t);if(null==s)break;this._items.push(s),s.selected=t===this._selectedIndex,s.clickHandler=e.Handler.create(this,this.itemClick,[t],!1)}}set_dataSource(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.selectedIndex=parseInt(t):t instanceof Array?this.labels=t.join(","):super.set_dataSource(t)}}class D extends z{createItem(t,e){let s=new O;return s._skinBaseUrl=this._skinBaseUrl,t&&(s.skin=t),s.label=e,s}}class P extends n{constructor(){super(...arguments),this._oldW=0,this._oldH=0}onResize(){if(this.width>0&&this.height>0){let t=e.ILaya.stage,s=Math.min(t.width/this._oldW,t.height/this._oldH);super.width=t.width,super.height=t.height,this.scale(s,s)}}onEnable(){e.ILaya.stage.on("resize",this,this.onResize),this.onResize()}onDisable(){e.ILaya.stage.off("resize",this,this.onResize)}_transChanged(t){super._transChanged(t),this._oldW=this._width,this._oldH=this._height}}class A extends z{constructor(){super(),this._stateNum=o.buttonStateNum}createItem(t,e){let s=new _;return s._skinBaseUrl=this._skinBaseUrl,t&&(s.skin=t),s.label=e,s}}class U extends p{get skin(){return this._skin}set skin(t){""==t&&(t=null),this._skin!=t&&this._setSkin(t)}get sizeGrid(){return this._graphics&&this._graphics.sizeGrid?this._graphics.sizeGrid.join(","):null}set sizeGrid(t){this._graphics.sizeGrid=t?r.fillArray(o.defaultSizeGrid,t,Number):null}get multiline(){return this._tf.multiline}set multiline(t){this._tf.multiline=t}get editable(){return this._tf.editable}set editable(t){this._tf.editable=t}get restrict(){return this._tf.restrict}set restrict(t){this._tf.restrict=t}get prompt(){return this._tf.prompt}set prompt(t){this._tf.prompt=t}get promptColor(){return this._tf.promptColor}set promptColor(t){this._tf.promptColor=t}get maxChars(){return this._tf.maxChars}set maxChars(t){this._tf.maxChars=t}get focus(){return this._tf.focus}set focus(t){this._tf.focus=t}get type(){return this._tf.type}set type(t){this._tf.type=t}constructor(t){super(),null!=t&&(this.text=t),this.skin=this.skin}_setSkin(t){if(this._skin=t,t){this._skinBaseUrl&&(t=e.URL.formatURL(t,this._skinBaseUrl));let s=e.Loader.getRes(t);return s?(this._skinLoaded(s),Promise.resolve()):e.ILaya.loader.load(t,e.Loader.IMAGE).then((t=>this._skinLoaded(t)))}return this._skinLoaded(null),Promise.resolve()}_skinLoaded(t){this._destroyed||(this._graphics.source=t,this._sizeChanged(),this.event(e.Event.LOADED))}_transChanged(t){super._transChanged(t),0!=(t&e.TransformKind.Size)&&this._graphics&&(this._isWidthSet&&(this._graphics.width=this._width),this._isHeightSet&&(this._graphics.height=this._height))}createChildren(){this.setGraphics(new i,!0),this._tf=new e.Input,this._tf.hideFlags=e.HideFlags.HideAndDontSave,this._tf.padding=o.inputLabelPadding,this._tf._onPostLayout=()=>this._onPostLayout(),this._tf.on(e.Event.INPUT,(()=>this.event(e.Event.INPUT))),this._tf.on(e.Event.ENTER,(()=>this.event(e.Event.ENTER))),this._tf.on(e.Event.BLUR,(()=>this.event(e.Event.BLUR))),this._tf.on(e.Event.FOCUS,(()=>this.event(e.Event.FOCUS))),this.addChild(this._tf)}initialize(){this.width=128,this.height=22}select(){this._tf.select()}setSelection(t,e){this._tf.setSelection(t,e)}}class W extends U{get scrollType(){return this._scrollType}set scrollType(e){this._scrollType=e,this._scrollType==t.ScrollType.None?(this._hScrollBar&&(this._hScrollBar.destroy(),this._hScrollBar=null),this._vScrollBar&&(this._vScrollBar.destroy(),this._vScrollBar=null)):this._scrollType==t.ScrollType.Horizontal?(this._vScrollBar&&(this._vScrollBar.destroy(),this._vScrollBar=null),this._hScrollBar?this._hScrollBar.skin=this._hScrollBarSkin:this.createHScrollBar()):this._scrollType==t.ScrollType.Vertical?(this._hScrollBar&&(this._hScrollBar.destroy(),this._hScrollBar=null),this._vScrollBar?this._vScrollBar.skin=this._vScrollBarSkin:this.createVScrollBar()):(this._hScrollBar?this._hScrollBar.skin=this._hScrollBarSkin:this.createHScrollBar(),this._vScrollBar?this._vScrollBar.skin=this._vScrollBarSkin:this.createVScrollBar())}get vScrollBar(){return this._vScrollBar}get hScrollBar(){return this._hScrollBar}get maxScrollY(){return this._tf.maxScrollY}get scrollY(){return this._tf.scrollY}get maxScrollX(){return this._tf.maxScrollX}get scrollX(){return this._tf.scrollX}get vScrollBarSkin(){return this._vScrollBarSkin}set vScrollBarSkin(e){""==e&&(e=null),this._vScrollBarSkin!=e&&(this._vScrollBarSkin=e,0==this._scrollType?this.scrollType=t.ScrollType.Vertical:this._scrollType==t.ScrollType.Horizontal?this.scrollType=t.ScrollType.Both:this.scrollType=this._scrollType)}get hScrollBarSkin(){return this._hScrollBarSkin}set hScrollBarSkin(e){""==e&&(e=null),this._hScrollBarSkin!=e&&(this._hScrollBarSkin=e,0==this._scrollType?this.scrollType=t.ScrollType.Horizontal:this._scrollType==t.ScrollType.Vertical&&(this.scrollType=t.ScrollType.Both),this.scrollType=this._scrollType)}constructor(t){super(t),this._scrollType=0}_onPostLayout(){super._onPostLayout(),this.callLater(this.changeScroll)}_transChanged(t){super._transChanged(t),0!=(t&e.TransformKind.Size)&&this.callLater(this.changeScroll)}initialize(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0}createHScrollBar(){this._hScrollBar=new v,this._hScrollBar.hideFlags=e.HideFlags.HideAndDontSave,this._hScrollBar._skinBaseUrl=this._skinBaseUrl,this._hScrollBar.skin=this._hScrollBarSkin,this.addChild(this._hScrollBar),this._hScrollBar.on(e.Event.CHANGE,this,this.onHBarChanged),this._hScrollBar.on(e.Event.LOADED,this,this.changeScroll),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.touchScrollEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)}createVScrollBar(){this._vScrollBar=new C,this._vScrollBar.hideFlags=e.HideFlags.HideAndDontSave,this._vScrollBar._skinBaseUrl=this._skinBaseUrl,this._vScrollBar.skin=this._vScrollBarSkin,this.addChild(this._vScrollBar),this._vScrollBar.on(e.Event.CHANGE,this,this.onVBarChanged),this._vScrollBar.on(e.Event.LOADED,this,this.changeScroll),this._vScrollBar.touchScrollEnable=!1,this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)}onVBarChanged(t){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)}onHBarChanged(t){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)}changeScroll(){let t=this._vScrollBar&&this._tf.maxScrollY>0,e=this._hScrollBar&&this._tf.maxScrollX>0,s=this._tf.padding,i=t?this._width-this._vScrollBar.width-s[2]:this._width,h=e?this._height-this._hScrollBar.height-s[3]:this._height;this._tf.size(i,h),this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-s[2],this._vScrollBar.y=s[1],this._vScrollBar.height=this._height-(e?this._hScrollBar.height:0)-s[1]-s[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=h/Math.max(this._tf.textHeight,h),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=t),this._hScrollBar&&(this._hScrollBar.x=s[0],this._hScrollBar.y=this._height-this._hScrollBar.height-s[3],this._hScrollBar.width=this._width-(t?this._vScrollBar.width:0)-s[0]-s[2],this._hScrollBar.scrollSize=Math.max(.033*i,1),this._hScrollBar.thumbPercent=i/Math.max(this._tf.textWidth,i),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=e)}scrollTo(t){this.commitMeasure(),this._tf.scrollY=t}destroy(t=!0){this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null,super.destroy(t)}}class N extends a{get defaultTipHandler(){return this._defaultTipHandler}set defaultTipHandler(t){this._defaultTipHandler=t}constructor(){super(),this._tipBox=new a,this._tipBox.addChild(this._tipText=new e.Text),this._tipText.x=this._tipText.y=5,this._tipText.color=N.tipTextColor,this._defaultTipHandler=this._showDefaultTip,e.ILaya.stage.on(t.UIEvent.SHOW_TIP,this,this._onStageShowTip),e.ILaya.stage.on(t.UIEvent.HIDE_TIP,this,this._onStageHideTip),this.zOrder=1100}_onStageHideTip(t){e.ILaya.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()}_onStageShowTip(t){e.ILaya.timer.once(N.tipDelay,this,this._showTip,[t],!0)}_showTip(t){if("string"==typeof t){var s=String(t);Boolean(s)&&this._defaultTipHandler(s)}else t instanceof e.Handler?t.run():t instanceof Function&&t.apply();e.ILaya.stage.on(e.Event.MOUSE_MOVE,this,this._onStageMouseMove),e.ILaya.stage.on(e.Event.MOUSE_DOWN,this,this._onStageMouseDown),this._onStageMouseMove(null)}_onStageMouseDown(t){this.closeAll()}_onStageMouseMove(t){this._showToStage(this,N.offsetX,N.offsetY)}_showToStage(t,s=0,i=0){let h=t.getBounds(e.Rectangle.TEMP);t.x=e.ILaya.stage.mouseX+s,t.y=e.ILaya.stage.mouseY+i,t._x+h.width>e.ILaya.stage.width&&(t.x-=h.width+s),t._y+h.height>e.ILaya.stage.height&&(t.y-=h.height+i)}_showDefaultTip(t){this._tipText.text=t;var s=this._tipBox.graphics;s.clear(!0),s.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,N.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),e.ILaya.stage.addChild(this)}closeAll(){e.ILaya.timer.clear(this,this._showTip),e.ILaya.stage.off(e.Event.MOUSE_MOVE,this,this._onStageMouseMove),e.ILaya.stage.off(e.Event.MOUSE_DOWN,this,this._onStageMouseDown),this.removeChildren()}showDislayTip(t){this.addChild(t),this._showToStage(this),e.ILaya.stage.addChild(this)}}N.offsetX=10,N.offsetY=15,N.tipTextColor="#ffffff",N.tipBackColor="#111111",N.tipDelay=200;class R extends n{get keepStatus(){return this._keepStatus}set keepStatus(t){this._keepStatus=t}get array(){return this._list.array}set array(t){this._keepStatus&&this._list.array&&t&&this.parseOpenStatus(this._list.array,t),this._source=t,this._list.array=this.getArray()}get source(){return this._source}get list(){return this._list}get itemRender(){return this._list.itemRender}set itemRender(t){this._list.itemRender=t}get scrollBarSkin(){return this._list.vScrollBarSkin}set scrollBarSkin(t){this._list.vScrollBarSkin=t}get scrollBar(){return this._list.scrollBar}get mouseHandler(){return this._list.mouseHandler}set mouseHandler(t){this._list.mouseHandler=t}get renderHandler(){return this._renderHandler}set renderHandler(t){this._renderHandler=t}get spaceLeft(){return this._spaceLeft}set spaceLeft(t){this._spaceLeft=t}get spaceBottom(){return this._list.spaceY}set spaceBottom(t){this._list.spaceY=t}get selectedIndex(){return this._list.selectedIndex}set selectedIndex(t){this._list.selectedIndex=t}get selectedItem(){return this._list.selectedItem}set selectedItem(t){this._list.selectedItem=t}set xml(t){var e=[];this.parseXml(t,e,null,!0),this.array=e}get selectedPath(){return this._list.selectedItem?this._list.selectedItem.path:null}constructor(){super(),this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,this.width=this.height=200}createChildren(){this._list=new b,this._list.hideFlags=e.HideFlags.HideAndDontSave,this._list.left=0,this._list.right=0,this._list.top=0,this._list.bottom=0,this._list._skinBaseUrl=this._skinBaseUrl,this.addChild(this._list),this._list.renderHandler=e.Handler.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on(e.Event.CHANGE,this,this.onListChange)}onListChange(t=null){this.event(e.Event.CHANGE)}getArray(){var t=[];for(let e in this._source){let s=this._source[e];this.getParentOpenStatus(s)&&(s.x=this._spaceLeft*this.getDepth(s),t.push(s))}return t}getDepth(t,e=0){return null==t.nodeParent?e:this.getDepth(t.nodeParent,e+1)}getParentOpenStatus(t){var e=t.nodeParent;return null==e||!!e.isOpen&&(null==e.nodeParent||this.getParentOpenStatus(e))}renderItem(t,s){var i=t.dataSource;if(i){t.left=i.x;let h=t.getChild("arrow");h&&(i.hasChild?(h.visible=!0,h.index=i.isOpen?1:0,h.__cellIndex=s,h.off(e.Event.CLICK,this,this.onArrowClick),h.on(e.Event.CLICK,this,this.onArrowClick)):h.visible=!1);let l=t.getChild("folder");l&&(2==l.clipY?l.index=i.isDirectory?0:1:l.index=i.isDirectory?i.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([t,s])}}onArrowClick(t){var s=t.currentTarget.__cellIndex;this._list.array[s].isOpen=!this._list.array[s].isOpen,this.event(e.Event.OPEN),this._list.array=this.getArray()}parseXml(t,e,s,i){var h,l=t.elements(),r=l.length;if(!i){h={};var a=t.attributes;for(let t in a){var n=a[t];h[t]="true"==n||"false"!=n&&n}h.nodeParent=s,r>0&&(h.isDirectory=!0),h.hasChild=r>0,e.push(h)}for(var o=0;o<r;o++){var _=l[o];this.parseXml(_,e,h,!1)}}parseOpenStatus(t,e){for(var s=0,i=e.length;s<i;s++){var h=e[s];if(h.isDirectory)for(var l=0,r=t.length;l<r;l++){var a=t[l];if(a.isDirectory&&this.isSameParent(a,h)&&h.label==a.label){h.isOpen=a.isOpen;break}}}}isSameParent(t,e){return null==t.nodeParent&&null==e.nodeParent||null!=t.nodeParent&&null!=e.nodeParent&&(t.nodeParent.label==e.nodeParent.label&&this.isSameParent(t.nodeParent,e.nodeParent))}getFilterSource(t,e,s){s=s.toLocaleLowerCase();for(let i of t)!i.isDirectory&&String(i.label).toLowerCase().indexOf(s)>-1&&(i.x=0,e.push(i)),i.child&&i.child.length>0&&this.getFilterSource(i.child,e,s)}setItemState(t,e){this._list.array[t]&&(this._list.array[t].isOpen=e,this._list.array=this.getArray())}fresh(){this._list.array=this.getArray(),this.repaint()}set_dataSource(t){this._dataSource=t,super.set_dataSource(t)}filter(t){if(Boolean(t)){var e=[];this.getFilterSource(this._source,e,t),this._list.array=e}else this._list.array=this.getArray()}destroy(t=!0){super.destroy(t),this._list&&this._list.destroy(t),this._list=null,this._source=null,this._renderHandler=null}}class V extends w{constructor(){super(...arguments),this.isSortItem=!1}_transChanged(t){super._transChanged(t),0!=(t&e.TransformKind.Width)&&this.callLater(this.changeItems)}changeItems(){this._itemChanged=!1;let t=[],e=0;for(let s=0,i=this.numChildren;s<i;s++){let i=this.getChildAt(s);i&&(i.y=0,t.push(i),e=this._isWidthSet?this._width:Math.max(e,i.width*i.scaleX))}this.isSortItem&&this.sortItem(t);let s=0;for(let i=0,h=t.length;i<h;i++){let h=t[i];h.y=s,s+=h.height*h.scaleY+this._space,this._align==V.LEFT?h.x=0:this._align==V.CENTER?h.x=.5*(e-h.width*h.scaleX):this._align==V.RIGHT&&(h.x=e-h.width*h.scaleX)}this._sizeChanged()}}V.NONE="none",V.LEFT="left",V.CENTER="center",V.RIGHT="right";class F extends n{get selectedIndex(){return this._selectedIndex}set selectedIndex(t){this._selectedIndex!=t&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=t,this.setSelect(this._selectedIndex,!0))}get selection(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null}set selection(t){this.selectedIndex=this._items.indexOf(t)}get setIndexHandler(){return this._setIndexHandler}set setIndexHandler(t){this._setIndexHandler=t}get items(){return this._items}constructor(){super(),this._setIndexHandler=e.Handler.create(this,this.setIndex,null,!1),this._items=[]}setSelect(t,e){this._items&&t>-1&&t<this._items.length&&(this._items[t].visible=e)}setIndex(t){this.selectedIndex=t}setItems(t){this.removeChildren();for(var e=0,s=0,i=t.length;s<i;s++){var h=t[s];h&&(h.name="item"+e,this.addChild(h),e++)}this.initItems()}addItem(t){t.name="item"+this._items.length,this.addChild(t),this.initItems()}onAfterDeserialize(){super.onAfterDeserialize(),this.initItems()}_afterInited(){this.initItems()}initItems(){this._items.length=0;for(var t=0;t<1e4;t++){var e=this.getChild("item"+t);if(null==e)break;this._items.push(e),e.visible=t==this._selectedIndex}}set_dataSource(t){if(this._dataSource=t,"number"==typeof t||"string"==typeof t)this.selectedIndex=parseInt(t);else for(var e in this._dataSource)e in this&&(this[e]=this._dataSource[e])}}class Y extends f{}let G=e.ClassUtils.regClass;G("AutoBitmap",i),G("Box",n),G("Button",_),G("CheckBox",d),G("Clip",u),G("ColorPicker",g),G("ComboBox",y),G("Dialog",k),G("DialogManager",B),G("FontClip",E),G("HBox",L),G("HScrollBar",v),G("HSlider",I),G("Image",S),G("Label",p),G("LayoutBox",w),G("List",b),G("Panel",T),G("ProgressBar",H),G("Radio",O),G("RadioGroup",D),G("ScaleBox",P),G("ScrollBar",m),G("Slider",f),G("Tab",A),G("TextArea",W),G("TextInput",U),G("TipManager",N),G("Tree",R),G("UIGroup",z),G("UIUtils",r),G("VBox",V),G("View",x),G("ViewStack",F),G("VScrollBar",C),G("VSlider",Y),G("UIComponent",a),t.AutoBitmap=i,t.Box=n,t.Button=_,t.CheckBox=d,t.Clip=u,t.ColorPicker=g,t.ComboBox=y,t.Dialog=k,t.DialogManager=B,t.FontClip=E,t.HBox=L,t.HScrollBar=v,t.HSlider=I,t.Image=S,t.Label=p,t.LayoutBox=w,t.List=b,t.Panel=T,t.ProgressBar=H,t.Radio=O,t.RadioGroup=D,t.ScaleBox=P,t.ScrollBar=m,t.Slider=f,t.Styles=o,t.Tab=A,t.TextArea=W,t.TextInput=U,t.TipManager=N,t.Tree=R,t.UIComponent=a,t.UIConfig=s,t.UIGroup=z,t.UIUtils=r,t.VBox=V,t.VScrollBar=C,t.VSlider=Y,t.View=x,t.ViewStack=F}(window.Laya=window.Laya||{},Laya);